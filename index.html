<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/09/jQuery&&ajax/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/09/jQuery&&ajax/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-09 14:02:45 / 修改时间：15:30:53" itemprop="dateCreated datePublished" datetime="2024-01-09T14:02:45+08:00">2024-01-09</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="jQuery-ajax"><a href="#jQuery-ajax" class="headerlink" title="jQuery&amp;&amp;ajax"></a>jQuery&amp;&amp;ajax</h1><p>补充还有一中方法获取全局变量</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109133026932.png" alt="image-20240109133026932"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109133103578.png" alt="image-20240109133103578"></p>
<p>js和html的交互</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109133349526.png" alt="image-20240109133349526"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109133805116.png" alt="image-20240109133805116"></p>
<p>一般不会直接</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109134227794.png" alt="image-20240109134227794"></p>
<p>绑定事件在htnl里面</p>
<p>而是在</p>
<p>js里面绑定如上面的click事件</p>
<p>上面写的不对应该写在后面</p>
<p>这种解决方案不好</p>
<p>这种方法<img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109135323623.png" alt="image-20240109135323623"></p>
<p>等页面加载完以后在执行这个动作</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109135626260.png" alt="image-20240109135626260"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109135636620.png" alt="image-20240109135636620"></p>
<p>然后查看代码</p>
<p>只有短短的几句话</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109135738942.png" alt="image-20240109135738942"></p>
<p>elements是经过js加工以后的</p>
<p>但是页面的源代码是没有经过加工以后的</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109135901544.png" alt="image-20240109135901544"></p>
<p>所以js事件可以改变html代码里面的东西</p>
<p>​	form</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109140017863.png" alt="image-20240109140017863"></p>
<p>把form整体的东西都提交到服务器</p>
<p>绑定事件的第三种方法</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109140239811.png" alt="image-20240109140239811"></p>
<p>对用户名字和密码进行非空校验</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109140418062.png" alt="image-20240109140418062"></p>
<p>直接通过id搜索也行或者直接第二种方法很少用了</p>
<p>第三种</p>
<p>通过css选择器</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109140607222.png" alt="image-20240109140607222"></p>
<p>通过value获取输入的内容</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109140707812.png" alt="image-20240109140707812"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109140812834.png" alt="image-20240109140812834"></p>
<p>.是类选择器</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109141021271.png" alt="image-20240109141021271"></p>
<p>以上都是补充的</p>
<p>原生的js</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109141720293.png" alt="image-20240109141720293"></p>
<p>很复杂</p>
<p>所以jQuery让写代码很清爽</p>
<p>是一个js的库</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109141828439.png" alt="image-20240109141828439"></p>
<p>下载</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109141946908.png" alt="image-20240109141946908"></p>
<p>这个包第二个把空格和换行没有而且变量的名字缩短了</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109142508630.png" alt="image-20240109142508630"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109142805305.png" alt="image-20240109142805305"></p>
<p>绑定的事件</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109143406965.png" alt="image-20240109143406965"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109143502205.png" alt="image-20240109143502205"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109143515180.png" alt="image-20240109143515180"></p>
<p>选择以后就有checked的属性</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109143704450.png" alt="image-20240109143704450"></p>
<p>标签的交互</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109143917083.png" alt="image-20240109143917083"></p>
<p>向标签中加入东西</p>
<p>如果text里面没有都关系就会向外面取参数</p>
<p>val也是</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109145140239.png" alt="image-20240109145140239"></p>
<p>这样的</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109145156555.png" alt="image-20240109145156555"></p>
<p>一些简单你的操作</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109150158255.png" alt="image-20240109150158255"></p>
<p>如果想要在text里换行</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109150455249.png" alt="image-20240109150455249"></p>
<p>是不行的</p>
<p>在里面是默认是输出的文本所以需要使用html</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109150546098.png" alt="image-20240109150546098"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109150745013.png" alt="image-20240109150745013"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109150827722.png" alt="image-20240109150827722"></p>
<p>属性设置</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109150907282.png" alt="image-20240109150907282"></p>
<p>和上面的css的用法是一样的</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109151025597.png" alt="image-20240109151025597"></p>
<p>属性控制</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109151110643.png" alt="image-20240109151110643"></p>
<p>遍历器</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109151420870.png" alt="image-20240109151420870"></p>
<p>这样就全弄出来了</p>
<p>既可以用each</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109151539263.png" alt="image-20240109151539263"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109151621918.png" alt="image-20240109151621918"></p>
<p>这样就可以拿到li下的每一个了</p>
<p>一项一项的</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109151702280.png" alt="image-20240109151702280"></p>
<p>可以有参数</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109151741624.png" alt="image-20240109151741624"></p>
<p>参数的data就是this</p>
<p>参数的i就是索引</p>
<h1 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h1><p>同步刷新：全页面刷新：当进入页面一次性把全部的页面都扑出来</p>
<p>异步刷新：局部刷新：把局部的东西请求服务器返回的内容进行数据更新</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109152314429.png" alt="image-20240109152314429"></p>
<p>整个页面没有只有这个东西再加载</p>
<p>这样就可以</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109152710426.png" alt="image-20240109152710426"></p>
<p>还要有处理请求的</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109152913325.png" alt="image-20240109152913325"></p>
<p>&#x2F;就相当于根目录</p>
<p>访问127.0.0.1：5000&#x2F;就会进入这个函数‘</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109153005316.png" alt="image-20240109153005316"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109153022898.png" alt="image-20240109153022898"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/09/javascript%E5%85%A5%E9%97%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/09/javascript%E5%85%A5%E9%97%A8/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-09 09:19:42 / 修改时间：13:25:44" itemprop="dateCreated datePublished" datetime="2024-01-09T09:19:42+08:00">2024-01-09</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="javascript入门"><a href="#javascript入门" class="headerlink" title="javascript入门"></a>javascript入门</h1><p>js我感觉和python很像</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109092029164.png" alt="image-20240109092029164"></p>
<p>应用于浏览器表单类的</p>
<p>javascript可以在浏览器端进行校验</p>
<p>比如你在注册的时候，信息就不会返回到服务端之前的</p>
<p>js’</p>
<p>可以获取到html的内容</p>
<p>引入js文件</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109093243965.png" alt="image-20240109093243965"></p>
<p>sctipt的先后顺序</p>
<p>基本的数据类型</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109093449079.png" alt="image-20240109093449079"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109093534084.png" alt="image-20240109093534084"></p>
<p>声明变量</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109093646800.png" alt="image-20240109093646800"></p>
<p>没有值直接用此时这个变量不能使用</p>
<p>最好用控制台打印</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109093858953.png" alt="image-20240109093858953"></p>
<p>直接打开网站是看不见的</p>
<p>需要使用控制台</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109094231177.png" alt="image-20240109094231177"></p>
<p>只要是数据类型就是num</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109094316997.png" alt="image-20240109094316997"></p>
<p>这样的a变量没有被定义</p>
<p>字符串类类型拼接</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109094459787.png" alt="image-20240109094459787"></p>
<p>有一个是字符纯的话就会拼接</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109094553370.png" alt="image-20240109094553370"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109094611807.png" alt="image-20240109094611807"></p>
<p>num转换成字符串</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109094758132.png" alt="image-20240109094758132"></p>
<p>坑</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109094835854.png" alt="image-20240109094835854"></p>
<p>但是</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109094944347.png" alt="image-20240109094944347"></p>
<p>在比较的时候</p>
<p>一般使用三个&#x3D;来进行判断</p>
<p>python的三元表达式</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109095053325.png" alt="image-20240109095053325"></p>
<p>js的运算规则</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109095129137.png" alt="image-20240109095129137"></p>
<p>如果前面的成立</p>
<p>返回a</p>
<p>不成立的话</p>
<p>返回b</p>
<p>字符串的操作</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109102230636.png" alt="image-20240109102230636"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109102420799.png" alt="image-20240109102420799"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109102518309.png" alt="image-20240109102518309"></p>
<p>最后一个没有的话就返回-1</p>
<p>js的条件分支</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109103039867.png" alt="image-20240109103039867"></p>
<p>感觉整体和c语言差不多</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109103200504.png" alt="image-20240109103200504"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109103252253.png" alt="image-20240109103252253"></p>
<p>case穿透</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109103401021.png" alt="image-20240109103401021"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109103517568.png" alt="image-20240109103517568"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109103619524.png" alt="image-20240109103619524"></p>
<p>每一个都传递给里的函数</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109103755263.png" alt="image-20240109103755263"></p>
<p>这两中方法是一样的</p>
<p>c<img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109103929649.png" alt="image-20240109103929649"></p>
<p>这个用法也一样</p>
<p>js的函数</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109104119103.png" alt="image-20240109104119103"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109104159960.png" alt="image-20240109104159960"></p>
<p>把函数赋值给变量</p>
<p>特别灵活</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109104305258.png" alt="image-20240109104305258"></p>
<p>在前端任何东西都可以加括号<img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109104436608.png" alt="image-20240109104436608"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109104443170.png" alt="image-20240109104443170"></p>
<p>局部变量<img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109104754594.png" alt="image-20240109104754594"></p>
<p>基础进阶</p>
<p>定时器</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109105224137.png" alt="image-20240109105224137"></p>
<p>两个参数</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109105259763.png" alt="image-20240109105259763"></p>
<p>清理</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109105352215.png" alt="image-20240109105352215"></p>
<p>第二种</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109105429020.png" alt="image-20240109105429020"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109105434958.png" alt="image-20240109105434958"></p>
<p>像停掉她还是上面的方法</p>
<p>有些网站检测是否打开控制台</p>
<p>然后检测到以后就会执行定时的操作</p>
<p>每隔多少就会往浏览器写内存的数据</p>
<p>造成奇卡无比</p>
<p>处理的话就会停掉</p>
<p>setintval</p>
<p>settimeout</p>
<p>关于时间</p>
<p>获取当前的时间</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109105912895.png" alt="image-20240109105912895"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109105919728.png" alt="image-20240109105919728"></p>
<p>看起里麻烦想要格式化</p>
<p>获取年份</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109110045357.png" alt="image-20240109110045357"></p>
<p>月份</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109110100578.png" alt="image-20240109110100578"></p>
<p>月份是从0开始算的</p>
<p>整体时相似的</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109110207515.png" alt="image-20240109110207515"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109110232200.png" alt="image-20240109110232200"></p>
<p>时间戳</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109110408899.png" alt="image-20240109110408899"></p>
<p>从1970年开始</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109110430039.png" alt="image-20240109110430039"></p>
<p>单位是毫秒</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109110526058.png" alt="image-20240109110526058"></p>
<p>一般在网站请求有一个这个</p>
<p>后面的数字就是时间戳</p>
<p>作用就是判断请求是什么时候发送的</p>
<p>get请求会产生缓存，这样就每次产生新的请求，防止缓存影响</p>
<p>eval<img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109111159599.png" alt="image-20240109111159599"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109111345438.png" alt="image-20240109111345438"></p>
<p>eval的解密</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109111418186.png" alt="image-20240109111418186"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109111529151.png" alt="image-20240109111529151"></p>
<p>prototype</p>
<p>定义一个类</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109111705500.png" alt="image-20240109111705500"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109111748735.png" alt="image-20240109111748735"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109111856535.png" alt="image-20240109111856535"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109112004641.png" alt="image-20240109112004641"></p>
<p>每一个new都会创建一个新对象</p>
<p>创建完类在添加方法</p>
<p><img src="E:\blog\source_posts\javascript入门.assets\image-20240109114616648.png" alt="image-20240109114616648"></p>
<p>闭包函数</p>
<p>变量的提升</p>
<p>只有在这里出现</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109120024875.png" alt="image-20240109120024875"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109120050292.png" alt="image-20240109120050292"></p>
<p>这种没有报错</p>
<p>说明不是运行过程</p>
<p>实际的过程</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109120210584.png" alt="image-20240109120210584"></p>
<p>自动将变量的声明提升到前面</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109120307548.png" alt="image-20240109120307548"></p>
<p>这样的作法是不好的</p>
<p>很不严谨</p>
<p>es6提出以后推荐使用let，let声明的变量不允许提升</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109120616216.png" alt="image-20240109120616216"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109120635058.png" alt="image-20240109120635058"></p>
<p>在同一个 作用域内部不可以声明两次</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109120722610.png" alt="image-20240109120722610"></p>
<p>const</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109121154751.png" alt="image-20240109121154751"></p>
<p>不允许更改</p>
<p>闭包</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109121459217.png" alt="image-20240109121459217"></p>
<p>这样打印的结果就是王力宏</p>
<p>python的话需要</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109121549402.png" alt="image-20240109121549402"></p>
<p>这样很危险</p>
<p>闭包</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109122149961.png" alt="image-20240109122149961"></p>
<p>假设网站引入了这两个包</p>
<p>最后引入小菜的</p>
<p>最后打印的是小菜</p>
<p>所以我想要大佬的变成局部的</p>
<p>然后在运行就是上面说的（）（）</p>
<p>这样也出现</p>
<p>如果在局部里面有一个函数怎么在外部进行使用</p>
<p>直接在内部return</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109122742395.png" alt="image-20240109122742395"></p>
<p>谁调用谁来接</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109122825723.png" alt="image-20240109122825723"></p>
<p>简略下</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109122847947.png" alt="image-20240109122847947"></p>
<p>这样外面就看可以 调用</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109122937246.png" alt="image-20240109122937246"></p>
<p>或者直接返回</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240109130445668.png" alt="image-20240109130445668"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/08/%E5%8D%8F%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/08/%E5%8D%8F%E7%A8%8B/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-01-08 14:23:21" itemprop="dateCreated datePublished" datetime="2024-01-08T14:23:21+08:00">2024-01-08</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="协程"><a href="#协程" class="headerlink" title="协程"></a>协程</h1><p>写成里面事件循环相当于一个人</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240107095255659.png" alt="image-20240107095255659"></p>
<p>监控着那个任务的io等待完成了</p>
<p>就会把任务再给一个线程</p>
<p>做轮询的操作</p>
<p>实现的方法</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240107101836521.png" alt="image-20240107101836521"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc1</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是1&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)<span class="comment">#为什么加await因为这里会有堵塞需要把他进行挂起，斌且不能用普通的sleep了需要使用astnico的</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1结束&quot;</span>)</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc2</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是2&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2结束&quot;</span>)</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc3</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是3&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;3结束&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    f1=fuc1()</span><br><span class="line">    f2=fuc2()</span><br><span class="line">    f3=fuc3()</span><br><span class="line">    <span class="comment">#把三个任务放在一起</span></span><br><span class="line">    <span class="comment"># loop = asyncio.new_event_loop()  # 创建一个新的事件循环对象</span></span><br><span class="line">    <span class="comment"># asyncio.set_event_loop(loop)</span></span><br><span class="line">    tasks=[</span><br><span class="line">        f1,</span><br><span class="line">        f2,</span><br><span class="line">        f3,</span><br><span class="line">    ]</span><br><span class="line">    <span class="comment"># asyncio.run(asyncio.wait(tasks))#wait等待</span></span><br><span class="line">    asyncio.run(asyncio.wait(tasks))</span><br></pre></td></tr></table></figure>

<p>有点报错</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">func</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是函数&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    re=func()</span><br><span class="line">    <span class="comment"># # #协程对象要执行必须有event_loop</span></span><br><span class="line">    <span class="comment"># loop=asyncio.get_event_loop()</span></span><br><span class="line">    <span class="comment"># # event_loop执行这个会有报错</span></span><br><span class="line">    <span class="comment"># loop.run_until_complete(re)</span></span><br><span class="line"><span class="comment">#或者这么写</span></span><br><span class="line">    asyncio.run(re)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">func</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是函数&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    re=func()</span><br><span class="line">    <span class="comment"># # #协程对象要执行必须有event_loop</span></span><br><span class="line">    <span class="comment"># loop=asyncio.get_event_loop()</span></span><br><span class="line">    <span class="comment"># # event_loop执行这个会有报错</span></span><br><span class="line">    <span class="comment"># loop.run_until_complete(re)</span></span><br><span class="line"><span class="comment">#或者这么写</span></span><br><span class="line">    asyncio.run(re)</span><br></pre></td></tr></table></figure>

<p>主要使用的方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span>  <span class="title function_">download</span>(<span class="params">url,t</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;下载开始&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(t)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;下载成功&quot;</span>)</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment">#假设有一堆的下载连链接</span></span><br><span class="line">    urls=[</span><br><span class="line">        <span class="string">&quot;https://www.baidu.com&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://www.jingdong.com&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://www.huohu.com&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://www.taobao.com&quot;</span>,</span><br><span class="line">    ]<span class="comment">#需要封装任务里表</span></span><br><span class="line">    tasks=[]</span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">        task=asyncio.create_task(download(url,<span class="number">2</span>))</span><br><span class="line">        tasks.append(task)</span><br><span class="line">    <span class="keyword">await</span> asyncio.wait(tasks)<span class="comment">#在协程对象里需要用到await等待他完成了在进行下一步的操作</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    asyncio.run(main())</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc1</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是1&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)<span class="comment">#为什么加await因为这里会有堵塞需要把他进行挂起，斌且不能用普通的sleep了需要使用astnico的</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1结束&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc2</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是2&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2结束&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;2&#x27;</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc3</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是3&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;3结束&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    f1=fuc1()</span><br><span class="line">    f2=fuc2()</span><br><span class="line">    f3=fuc3()</span><br><span class="line">    tasks=[</span><br><span class="line">        asyncio.create_task(f1),</span><br><span class="line">        asyncio.create_task(f2),</span><br><span class="line">        asyncio.create_task(f3)</span><br><span class="line">    ]</span><br><span class="line">    done,padding=<span class="keyword">await</span> asyncio.wait(tasks)<span class="comment">#done是已完成的，padding是正在进行</span></span><br><span class="line">    <span class="built_in">print</span>(done)</span><br><span class="line">    <span class="comment"># print(padding)#打印的是集合，集合的就是无序和不重复</span></span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> done:</span><br><span class="line">        <span class="built_in">print</span>(d)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    asyncio.run(main())</span><br></pre></td></tr></table></figure>

<p>打印的结果</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240107112955063.png" alt="image-20240107112955063"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc1</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是1&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)<span class="comment">#为什么加await因为这里会有堵塞需要把他进行挂起，斌且不能用普通的sleep了需要使用astnico的</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1结束&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc2</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是2&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2结束&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;2&#x27;</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc3</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是3&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;3结束&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    f1=fuc1()</span><br><span class="line">    f2=fuc2()</span><br><span class="line">    f3=fuc3()</span><br><span class="line">    tasks=[</span><br><span class="line">        asyncio.create_task(f1),</span><br><span class="line">        asyncio.create_task(f2),</span><br><span class="line">        asyncio.create_task(f3)</span><br><span class="line">    ]</span><br><span class="line">    done,padding=<span class="keyword">await</span> asyncio.wait(tasks)<span class="comment">#done是已完成的，padding是正在进行</span></span><br><span class="line">    <span class="built_in">print</span>(done)</span><br><span class="line">    <span class="comment"># print(padding)#打印的是集合，集合的就是无序和不重复</span></span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> done:</span><br><span class="line">        <span class="built_in">print</span>(d.result())</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    asyncio.run(main())</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc1</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是1&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)<span class="comment">#为什么加await因为这里会有堵塞需要把他进行挂起，斌且不能用普通的sleep了需要使用astnico的</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1结束&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc2</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是2&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2结束&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;2&#x27;</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc3</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是3&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;3结束&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    f1=fuc1()</span><br><span class="line">    f2=fuc2()</span><br><span class="line">    f3=fuc3()</span><br><span class="line">    tasks=[</span><br><span class="line">        asyncio.create_task(f1),</span><br><span class="line">        asyncio.create_task(f2),</span><br><span class="line">        asyncio.create_task(f3)</span><br><span class="line">    ]</span><br><span class="line">    done,padding=<span class="keyword">await</span> asyncio.wait(tasks)<span class="comment">#done是已完成的，padding是正在进行</span></span><br><span class="line">    <span class="built_in">print</span>(done)</span><br><span class="line">    <span class="comment"># print(padding)#打印的是集合，集合的就是无序和不重复</span></span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> done:</span><br><span class="line">        <span class="built_in">print</span>(d.result())</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    asyncio.run(main())</span><br></pre></td></tr></table></figure>

<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240107113203279.png" alt="image-20240107113203279"></p>
<p>gather</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc1</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是1&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)<span class="comment">#为什么加await因为这里会有堵塞需要把他进行挂起，斌且不能用普通的sleep了需要使用astnico的</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1结束&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc2</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是2&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2结束&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;2&#x27;</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fuc3</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是3&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;3结束&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    f1=fuc1()</span><br><span class="line">    f2=fuc2()</span><br><span class="line">    f3=fuc3()</span><br><span class="line">    tasks=[</span><br><span class="line">        asyncio.create_task(f1),</span><br><span class="line">        asyncio.create_task(f2),</span><br><span class="line">        asyncio.create_task(f3)</span><br><span class="line">    ]</span><br><span class="line">    <span class="comment"># done,padding=await asyncio.wait(tasks)#done是已完成的，padding是正在进行</span></span><br><span class="line">    <span class="comment"># print(done)</span></span><br><span class="line">    <span class="comment"># # print(padding)#打印的是集合，集合的就是无序和不重复</span></span><br><span class="line">    <span class="comment"># for d in done:</span></span><br><span class="line">    <span class="comment">#     print(d.result())</span></span><br><span class="line">    <span class="comment">#如果返回的需要的是有序的就需要使用gather</span></span><br><span class="line">    re=<span class="keyword">await</span> asyncio.gather(*tasks,return_exceptions=<span class="literal">False</span>)<span class="comment">#*tasks是为了吧task列表打散因为参数需要1，2，3这样的</span></span><br><span class="line">    <span class="built_in">print</span>(re)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    asyncio.run(main())</span><br></pre></td></tr></table></figure>

<p>放进去任务顺序和出来的顺序一致的（是返回值的顺序）</p>
<p>return_exceptions&#x3D;True,如果任务列表函数里面错误，返回错误的信息</p>
<p>如果flase就直接不会执行了，所有任务直接停止</p>
<p>两个异步堵塞需要的</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240107114340851.png" alt="image-20240107114340851"></p>
<p>发送请求和保存文件就需要这些包里面的东西</p>
<p>对图片的读取</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#aiohttp aiofile</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&quot;https://pic.netbian.com/uploads/allimg/240104/010334-1704301414ee4e.jpg&quot;,</span></span><br><span class="line"><span class="string">&quot;https://pic.netbian.com/uploads/allimg/240104/010502-1704301502fb3e.jpg&quot;,</span></span><br><span class="line"><span class="string">&quot;https://pic.netbian.com/uploads/allimg/231231/161202-17040103228aec.jpg&quot;,</span></span><br><span class="line"><span class="string">&quot;https://pic.netbian.com/uploads/allimg/240104/010142-1704301302faa1.jpg&quot;,</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#结构</span></span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> aiohttp,aiofile,asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">download</span>(<span class="params">url</span>):<span class="comment">#发送</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;开始下载&#x27;</span>)</span><br><span class="line">    filenma=url.split(<span class="string">&#x27;/&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line">    <span class="comment">#相当于request，那为什么不用request呢，因为他是基于同步的</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> aiohttp.ClientSession() <span class="keyword">as</span> session:<span class="comment">#加async的目的下，这个下面的都是以是异步的</span></span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">with</span> session.get(url) <span class="keyword">as</span> res:</span><br><span class="line">            <span class="comment"># await res.text()#有一些区别了</span></span><br><span class="line">            <span class="comment">#j进行异步</span></span><br><span class="line">            comtent=<span class="keyword">await</span> res.content.read()<span class="comment">#图片的数据</span></span><br><span class="line">            <span class="comment">#写入文件</span></span><br><span class="line">            <span class="keyword">async</span> <span class="keyword">with</span> aiofile.async_open(filenma,mode=<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="comment">#还要异步</span></span><br><span class="line">                <span class="keyword">await</span> f.write(comtent)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;over&quot;</span>)</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    urllist=[</span><br><span class="line">        <span class="string">&quot;https://pic.netbian.com/uploads/allimg/240104/010334-1704301414ee4e.jpg&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://pic.netbian.com/uploads/allimg/240104/010502-1704301502fb3e.jpg&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://pic.netbian.com/uploads/allimg/231231/161202-17040103228aec.jpg&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://pic.netbian.com/uploads/allimg/240104/010142-1704301302faa1.jpg&quot;</span>,</span><br><span class="line">    ]</span><br><span class="line">    tasks=[]</span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urllist:</span><br><span class="line">        t=asyncio.create_task(download(url))</span><br><span class="line">        tasks.append(t)</span><br><span class="line">    <span class="keyword">await</span> asyncio.wait(tasks)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    asyncio.run(main())</span><br></pre></td></tr></table></figure>

<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240107124008475.png" alt="image-20240107124008475"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/08/%E6%8A%93%E5%8F%96%E7%BD%91%E5%90%A7%E7%94%B5%E5%BD%B1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/08/%E6%8A%93%E5%8F%96%E7%BD%91%E5%90%A7%E7%94%B5%E5%BD%B1/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-01-08 14:23:16" itemprop="dateCreated datePublished" datetime="2024-01-08T14:23:16+08:00">2024-01-08</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="抓取网吧电影"><a href="#抓取网吧电影" class="headerlink" title="抓取网吧电影"></a>抓取网吧电影</h1><p>网站怎么爬取 视频</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240107191215370.png" alt="image-20240107191215370"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240107191237332.png" alt="image-20240107191237332"></p>
<p>几乎没有网站在video直接方视频的地址</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240107191329450.png" alt="image-20240107191329450"></p>
<p>因为加载会加载很大，就会导致</p>
<p>用户体验很差</p>
<p>造成资源</p>
<p>所以进行切片处理：吧大视频切成好几篇</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240107191651139.png" alt="image-20240107191651139"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240107191832936.png" alt="image-20240107191832936"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240107192016817.png" alt="image-20240107192016817"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240107192206532.png" alt="image-20240107192206532"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240107192259902.png" alt="image-20240107192259902"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/08/selenium/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/08/selenium/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-08 11:41:48 / 修改时间：15:31:16" itemprop="dateCreated datePublished" datetime="2024-01-08T11:41:48+08:00">2024-01-08</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="selenium-数据库"><a href="#selenium-数据库" class="headerlink" title="selenium&amp;数据库"></a>selenium&amp;数据库</h1><p>原来的网页</p>
<p>selenium获取cookie</p>
<p>就这个有用</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108111005116.png" alt="image-20240108111005116"></p>
<p>[{‘domain’: ‘.baidu.com’, ‘expiry’: 1736219300, ‘httpOnly’: False, ‘name’: ‘ZFY’, ‘path’: ‘&#x2F;‘, ‘sameSite’: ‘None’, ‘secure’: True, ‘value’: ‘z:AxPa4s:Af6VJacpvtxn5lAnwEy0rLGempLrBB6W1Dlg:C’}, {‘domain’: ‘.baidu.com’, ‘expiry’: 1704769699, ‘httpOnly’: False, ‘name’: ‘BA_HECTOR’, ‘path’: ‘&#x2F;‘, ‘sameSite’: ‘Lax’, ‘secure’: False, ‘value’: ‘ag8505a481210k6l0h01250h8i9psi1ipmpp31s’}, {‘domain’: ‘.baidu.com’, ‘expiry’: 1736219300, ‘httpOnly’: False, ‘name’: ‘BAIDUID_BFESS’, ‘path’: ‘&#x2F;‘, ‘sameSite’: ‘None’, ‘secure’: True, ‘value’: ‘802B5D92DB4323CC19D2E97A82381F77:FG&#x3D;1’}, {‘</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108111245608.png" alt="image-20240108111245608"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108111254301.png" alt="image-20240108111254301"></p>
<p>提取出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> selenium</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.edge.options <span class="keyword">import</span> Options</span><br><span class="line"><span class="keyword">from</span> msedge.selenium_tools <span class="keyword">import</span> EdgeOptions</span><br><span class="line"><span class="keyword">from</span> msedge.selenium_tools <span class="keyword">import</span> Edge</span><br><span class="line">edge_options = Options()</span><br><span class="line">edge_options.use_chromium = <span class="literal">True</span></span><br><span class="line">edge_options.add_argument(<span class="string">&#x27;--disable-blink-features=AutomationControlled&#x27;</span>)</span><br><span class="line"><span class="comment"># # 使用无头模式</span></span><br><span class="line"><span class="comment"># edge_options.add_argument(&#x27;--headless&#x27;)</span></span><br><span class="line"><span class="comment"># # 禁用GPU，防止无头模式出现莫名的BUG</span></span><br><span class="line"><span class="comment"># edge_options.add_argument(&#x27;--disable-gpu&#x27;)</span></span><br><span class="line"><span class="comment"># 将参数传给浏览器</span></span><br><span class="line">bro = webdriver.Edge(options=edge_options)</span><br><span class="line">bro.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">cookies=bro.get_cookies()</span><br><span class="line"><span class="built_in">print</span>(cookies)</span><br><span class="line">cookies_dict=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> cookies:</span><br><span class="line">    key=j[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">    value=j[<span class="string">&#x27;value&#x27;</span>]</span><br><span class="line">    cookies_dict[key]=value</span><br><span class="line"><span class="built_in">print</span>(cookies_dict)</span><br></pre></td></tr></table></figure>

<p>当你有一个字典的cooies直接作为参数传递给request</p>
<p>关于等待</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108112447915.png" alt="image-20240108112447915"></p>
<p>就是网页会跳出广告类似的</p>
<p>然后点×需要一会才可以下去</p>
<p>第二个不是必须等多少秒</p>
<p>还得是不点开那个东西，你的源码就加载不出	</p>
<p>而是加载完后就会继续就称为隐式等待</p>
<p>最后一个就复杂了</p>
<p>成显示等待</p>
<p>对于单独的一个去等</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108113052152.png" alt="image-20240108113052152"></p>
<p>10是最大时间</p>
<p>0.5是每个0.5检查一次</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108124625181.png" alt="image-20240108124625181"></p>
<p>boss直聘</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108114137752.png" alt="image-20240108114137752"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#导包</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC</span><br></pre></td></tr></table></figure>



<p>点选的需要动作链</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108120939828.png" alt="image-20240108120939828"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108121044575.png" alt="image-20240108121044575"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108121051329.png" alt="image-20240108121051329"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108121144353.png" alt="image-20240108121144353"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108121207305.png" alt="image-20240108121207305"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108121220965.png" alt="image-20240108121220965"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108121230280.png" alt="image-20240108121230280"></p>
<p>用selenium+lxml完成数据抓取</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108124742394.png" alt="image-20240108124742394"></p>
<p>滑块的</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108125504265.png" alt="image-20240108125504265"></p>
<p>抓着去移动</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108125528726.png" alt="image-20240108125528726"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108125615318.png" alt="image-20240108125615318"></p>
<p>滑块验证的不是为l那个而是</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108130203815.png" alt="image-20240108130203815"></p>
<p>会检测你的</p>
<p>添加这样的</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108130306274.png" alt="image-20240108130306274"></p>
<p>88以后的</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108130356857.png" alt="image-20240108130356857"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108130447122.png" alt="image-20240108130447122"></p>
<p>就是我之前加入的</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108130533955.png" alt="image-20240108130533955"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108135528276.png" alt="image-20240108135528276"></p>
<p>如果中间错误了前面的上传的数据也会回来上传不成功</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108135703452.png" alt="image-20240108135703452"></p>
<h2 id="mongodb"><a href="#mongodb" class="headerlink" title="mongodb"></a>mongodb</h2><p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108142237214.png" alt="image-20240108142237214"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108143322147.png" alt="image-20240108143322147"></p>
<p>当前工作的数据库</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108143443483.png" alt="image-20240108143443483"></p>
<p>test是内存层面的数据库</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108143533791.png" alt="image-20240108143533791"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108143749844.png" alt="image-20240108143749844"></p>
<p>数据库里面放着集合</p>
<p>建立有限大的集合</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108144300568.png" alt="image-20240108144300568"></p>
<p>capped滚动的</p>
<p>超过大小就会把最先的去掉</p>
<p>然后在存储</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108144451504.png" alt="image-20240108144451504"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108151059409.png" alt="image-20240108151059409"></p>
<p>多条的</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108151206707.png" alt="image-20240108151206707"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108151217839.png" alt="image-20240108151217839"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108151334398.png" alt="image-20240108151334398"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108151925272.png" alt="image-20240108151925272"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108152037066.png" alt="image-20240108152037066"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240108152320882.png" alt="image-20240108152320882"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/03/%E7%88%AC%E8%99%AB%E5%8D%87%E7%BA%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/03/%E7%88%AC%E8%99%AB%E5%8D%87%E7%BA%A7/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-01-03 19:11:43" itemprop="dateCreated datePublished" datetime="2024-01-03T19:11:43+08:00">2024-01-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-06 18:09:12" itemprop="dateModified" datetime="2024-01-06T18:09:12+08:00">2024-01-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="爬虫升级"><a href="#爬虫升级" class="headerlink" title="爬虫升级"></a>爬虫升级</h1><p>开端：</p>
<p>如何拿到动态加载的数据呢？</p>
<p>在之前的药检局的案例中</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103191559597.png" alt="image-20240103191559597"></p>
<p>可以发现网站应的包里的响应并没有我们要找的</p>
<p>然后我们可以全局搜索查看在其他的包中</p>
<p>然后在对应请求获取数据</p>
<p>就引入了 slenium的模块</p>
<h6 id="selenium模块的基本使用"><a href="#selenium模块的基本使用" class="headerlink" title="selenium模块的基本使用"></a>selenium模块的基本使用</h6><p>1.作用便捷的获取网站中动态加载的数据</p>
<p>2.便捷实现模拟登录</p>
<p>什么是selenium？</p>
<p>基于浏览器自动化的 一个模块</p>
<p>完成浏览器自动化的动作，编写代码不需要你动手</p>
<p>selenium的使用流程？</p>
<p>1.环境的安装</p>
<p>pip install selenium</p>
<ol start="2">
<li></li>
</ol>
<p>下载浏览器的驱动程序</p>
<p>下载成功后放在当前目录下</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103193518790.png" alt="image-20240103193518790"></p>
<ol start="3">
<li></li>
</ol>
<p>实例化一个浏览器对象：</p>
<ol start="4">
<li></li>
</ol>
<p>编写基于浏览器	自动化的操作代码</p>
<p>老师教的代码已经过时执行后会报错</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> selenium</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.edge.service <span class="keyword">import</span> Service</span><br><span class="line"></span><br><span class="line">service = Service(<span class="string">&#x27;msedgedriver.exe&#x27;</span>)</span><br><span class="line">driver = webdriver.Edge(service=service)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开xxx网站</span></span><br><span class="line">driver.get(<span class="string">&#x27;https://baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这是改进后的</p>
<p>目标实现：1.便捷实现动态加载的数据</p>
<p>代码需要把前面的修改以下可修改成我上的格式</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103200720429.png" alt="image-20240103200720429"></p>
<p>这样的操作就可以让我们获取当前页面动态加载的数据</p>
<p>之前直接去访问是获取不到的</p>
<p>拿到了</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103200828771.png" alt="image-20240103200828771"></p>
<p>因为网页找不到了我就不演示了</p>
<p>2.其他操作的实现</p>
<p>打开淘宝，然后进行搜索还有滚轮向下滚动</p>
<p>打开淘宝定位搜索框</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103201919721.png" alt="image-20240103201919721"></p>
<p>老师的操作</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103202730120.png" alt="image-20240103202730120"></p>
<p>这个已经过时了</p>
<p>定位到按钮</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103203310937.png" alt="image-20240103203310937"></p>
<p>class有两个标签纸</p>
<p>随便填一个就行</p>
<p>就此就可以完成搜索的任务</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> selenium</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.edge.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line">service=Service(<span class="string">&quot;msedgedriver.exe&quot;</span>)</span><br><span class="line">driver=webdriver.Edge(service=service)</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.taobao.com/&#x27;</span>)</span><br><span class="line"><span class="comment">#向搜索框录入指定的词</span></span><br><span class="line"><span class="comment">#先找到搜索框</span></span><br><span class="line"><span class="comment">#标签定位</span></span><br><span class="line">search_input=driver.find_element(By.ID,value=<span class="string">&quot;q&quot;</span>)</span><br><span class="line"><span class="comment">#标签的交互</span></span><br><span class="line">search_input.send_keys(<span class="string">&#x27;ipone&#x27;</span>)</span><br><span class="line"><span class="comment">#需要点击搜索按钮</span></span><br><span class="line">search_input2=driver.find_element(By.CLASS_NAME,value=<span class="string">&#x27;btn-search&#x27;</span>)</span><br><span class="line">search_input2.click()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>滚轮的操作</p>
<p>我们可以在控制台里z执行js代码从而实现滚轮的向下滑动</p>
<p>window.scrollTo(0,document.body.scrollHeight)</p>
<p>0是水平的像素</p>
<p>document.body.scrollHeight：是滑动一瓶的距离</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103204137700.png" alt="image-20240103204137700"></p>
<p>这样就实现了滚轮的滑动</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103204137700-17042857240361.png"></p>
<p>最新版的执行js的代码找不到了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> selenium</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.edge.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line">service=Service(<span class="string">&quot;msedgedriver.exe&quot;</span>)</span><br><span class="line">driver=webdriver.Edge(service=service)</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.taobao.com/&#x27;</span>)</span><br><span class="line"><span class="comment">#向搜索框录入指定的词</span></span><br><span class="line"><span class="comment">#先找到搜索框</span></span><br><span class="line"><span class="comment">#标签定位</span></span><br><span class="line">search_input=driver.find_element(By.ID,value=<span class="string">&quot;q&quot;</span>)</span><br><span class="line"><span class="comment">#标签的交互</span></span><br><span class="line">search_input.send_keys(<span class="string">&#x27;ipone&#x27;</span>)</span><br><span class="line"><span class="comment">#需要点击搜索按钮</span></span><br><span class="line"><span class="comment">#执行js代码</span></span><br><span class="line"><span class="comment"># search_input._execute(&#x27;window.scrollTo(0,document.body.scrollHeight)&#x27;,)</span></span><br><span class="line"><span class="comment"># time.sleep(5)</span></span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line">search_input2=driver.find_element(By.CLASS_NAME,value=<span class="string">&#x27;btn-search&#x27;</span>)</span><br><span class="line">search_input2.click()</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line">driver.get(<span class="string">&quot;https://baidu.com&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"><span class="comment">#执行回退的操作</span></span><br><span class="line">driver.back()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"><span class="comment">#前进</span></span><br><span class="line">driver.forward()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<h5 id="selenium处理iframe"><a href="#selenium处理iframe" class="headerlink" title="selenium处理iframe"></a>selenium处理iframe</h5><p>在页面中嵌套子页面</p>
<p>就是页面中常见的滑块验证</p>
<p>拖拽的操作</p>
<p>定位滑块发现</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103210624935.png" alt="image-20240103210624935"></p>
<p>在一个iframe标签下</p>
<p>对应是一个子页面</p>
<p>定位的标签是存在iframe中普通方法是找不到的</p>
<p>需要这样</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103210813811.png" alt="image-20240103210813811"></p>
<p>切换作用域</p>
<p>切换到iframe里面</p>
<p>在就去搜索标签</p>
<p>我还是不用最新版的把</p>
<p>重新安装旧版本的 </p>
<p>更改后的搜索东西</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> selenium</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">bro=webdriver.Edge(executable_path=<span class="string">&#x27;msedgedriver.exe&#x27;</span>)</span><br><span class="line">bro.get(<span class="string">&#x27;https://baidu.com&#x27;</span>)</span><br><span class="line">page_text=bro.page_source</span><br><span class="line">search_input=bro.find_element_by_id(<span class="string">&#x27;kw&#x27;</span>)<span class="comment">#定位到搜索框</span></span><br><span class="line">search_input.send_keys(<span class="string">&#x27;王昌晨&#x27;</span>)<span class="comment">#标签的交互</span></span><br><span class="line"><span class="comment">#按</span></span><br><span class="line">btm=bro.find_element_by_id(<span class="string">&#x27;su&#x27;</span>)</span><br><span class="line">btm.click()</span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<p>滚轮的滑动</p>
<p>滚轮拖动的代码</p>
<p>window.scrollTo(0,document.body.scrollHeight)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">bro=webdriver.Edge(executable_path=<span class="string">&#x27;msedgedriver.exe&#x27;</span>)</span><br><span class="line">bro.get(<span class="string">&#x27;https://baidu.com&#x27;</span>)</span><br><span class="line">page_text=bro.page_source</span><br><span class="line">search_input=bro.find_element_by_id(<span class="string">&#x27;kw&#x27;</span>)<span class="comment">#定位到搜索框</span></span><br><span class="line">search_input.send_keys(<span class="string">&#x27;王昌晨&#x27;</span>)<span class="comment">#标签的交互</span></span><br><span class="line"><span class="comment">#按</span></span><br><span class="line">btm=bro.find_element_by_id(<span class="string">&#x27;su&#x27;</span>)</span><br><span class="line">btm.click()</span><br><span class="line"><span class="comment"># 执行js代码</span></span><br><span class="line"><span class="comment"># time.sleep(1)</span></span><br><span class="line">bro.execute_script(<span class="string">&#x27;window.scrollTo(0,document.body.scrollHeight)&#x27;</span>)</span><br><span class="line"><span class="comment"># time.sleep(2)</span></span><br><span class="line">bro.get(<span class="string">&#x27;https://www.taobao.com&#x27;</span>)</span><br><span class="line">bro.back()</span><br><span class="line">bro.forward()</span><br></pre></td></tr></table></figure>

<p>真的很简单旧版的</p>
<p>iframe的处理</p>
<p>页面嵌套子页面</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line">bro=webdriver.Edge(executable_path=<span class="string">&#x27;msedgedriver.exe&#x27;</span>)</span><br><span class="line">bro.get(<span class="string">&#x27;https://baidu.com&#x27;</span>)</span><br><span class="line">page_text=bro.page_source</span><br><span class="line">search_input=bro.find_element_by_id(<span class="string">&#x27;kw&#x27;</span>)<span class="comment">#定位到搜索框</span></span><br><span class="line">search_input.send_keys(<span class="string">&#x27;王昌晨&#x27;</span>)<span class="comment">#标签的交互</span></span><br><span class="line"><span class="comment">#按</span></span><br><span class="line">btm=bro.find_element_by_id(<span class="string">&#x27;su&#x27;</span>)</span><br><span class="line">btm.click()</span><br><span class="line"><span class="comment"># 执行js代码</span></span><br><span class="line"><span class="comment"># time.sleep(1)</span></span><br><span class="line">bro.execute_script(<span class="string">&#x27;window.scrollTo(0,document.body.scrollHeight)&#x27;</span>)</span><br><span class="line"><span class="comment"># time.sleep(2)</span></span><br><span class="line">bro.get(<span class="string">&#x27;https://www.taobao.com&#x27;</span>)</span><br><span class="line">bro.back()</span><br><span class="line">bro.forward()</span><br><span class="line">bro.switch_to_frame(<span class="string">&#x27;iframe.&#x27;</span>)<span class="comment">#iframe的标签的属性值</span></span><br><span class="line"><span class="comment"># 动作链</span></span><br><span class="line">action=ActionChains(bro)</span><br><span class="line">action.click_and_hold(<span class="string">&#x27;div&#x27;</span>) <span class="comment">#点击长按指定的标签</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    action.move_by_offset(<span class="number">17</span>,<span class="number">0</span>).perform()<span class="comment">#进行拖动#perform让动作连立刻执行</span></span><br><span class="line">    sleep(<span class="number">2</span>)</span><br><span class="line"><span class="comment">#释放动作连</span></span><br><span class="line">action.release()</span><br><span class="line">bro.quit()</span><br></pre></td></tr></table></figure>

<p>#实现模拟登陆</p>
<p>qq空间</p>
<p>代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> selenium</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">bro=webdriver.Edge(executable_path=<span class="string">&#x27;msedgedriver.exe&#x27;</span>)</span><br><span class="line">bro.get(<span class="string">&#x27;https://qzone.qq.com/&#x27;</span>)</span><br><span class="line"><span class="comment"># time.sleep(3)</span></span><br><span class="line">bro.switch_to_frame(<span class="string">&#x27;login_frame&#x27;</span>)<span class="comment">#点击密码登录的按键在iframe下</span></span><br><span class="line">click_input=bro.find_element_by_id(<span class="string">&#x27;switcher_plogin&#x27;</span>)</span><br><span class="line">click_input.click()</span><br><span class="line">username=bro.find_element_by_id(<span class="string">&#x27;u&#x27;</span>)</span><br><span class="line"><span class="comment">#实现标签的交互</span></span><br><span class="line">username.send_keys(<span class="string">&#x27;3445883193&#x27;</span>)</span><br><span class="line">password=bro.find_element_by_id(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">password.send_keys(<span class="string">&#x27;wei3588559&#x27;</span>)</span><br><span class="line">login_btm=bro.find_element_by_id(<span class="string">&#x27;login_button&#x27;</span>)</span><br><span class="line">login_btm.click()</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">bro.quit()</span><br></pre></td></tr></table></figure>

<p>但是qq空间做了验证登录不进去</p>
<h5 id="无头浏览器规避检测"><a href="#无头浏览器规避检测" class="headerlink" title="无头浏览器规避检测"></a>无头浏览器规避检测</h5><p>让浏览器的弹出没有可视化的效果</p>
<p>通俗的就是说让浏览器不出来</p>
<p>也叫做无头浏览器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.edge.options <span class="keyword">import</span> Options<span class="comment"># 实现无可视化界面的操作,</span></span><br><span class="line"><span class="comment">#定义浏览器对象</span></span><br><span class="line"><span class="comment">#实现无可视化界面的操作,无可视化界面（无头浏览器）,要用直接复制，加上上面的引入</span></span><br><span class="line">options = Options()<span class="comment">#定义一个option对象</span></span><br><span class="line">options.add_argument(<span class="string">&quot;headless&quot;</span>)</span><br><span class="line"></span><br><span class="line">browser = webdriver.Edge(options = options)</span><br></pre></td></tr></table></figure>

<p>代码如下需要用的时候直接cv就可以</p>
<p>整了半天发现edge的无头设置不了</p>
<p>所以有安装了chorme的驱动</p>
<p>好好好不要太相信ai直接把，我们selenium包给崩了</p>
<p>还是先不设置无头了</p>
<p>实在搞不来</p>
<p>好的继续</p>
<p>那么如何规避掉selenium被检测的风险呢？</p>
<p>好好好还是重新学习把</p>
<p>4以上版本的无头代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> selenium</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.edge.options <span class="keyword">import</span> Options</span><br><span class="line"><span class="comment"># 无可视化界面设置 #</span></span><br><span class="line">edge_options = Options()</span><br><span class="line"><span class="comment"># 使用无头模式</span></span><br><span class="line">edge_options.add_argument(<span class="string">&#x27;--headless&#x27;</span>)</span><br><span class="line"><span class="comment"># 禁用GPU，防止无头模式出现莫名的BUG</span></span><br><span class="line">edge_options.add_argument(<span class="string">&#x27;--disable-gpu&#x27;</span>)</span><br><span class="line"><span class="comment"># 将参数传给浏览器</span></span><br><span class="line">bro = webdriver.Edge(options=edge_options)</span><br><span class="line">bro.get(<span class="string">&#x27;https://qzone.qq.com/&#x27;</span>)</span><br><span class="line">bro.switch_to.frame(<span class="string">&#x27;login_frame&#x27;</span>)</span><br><span class="line">click_input=bro.find_element(By.ID,value=<span class="string">&#x27;switcher_plogin&#x27;</span>)<span class="comment"># 定位后面是id的属性值</span></span><br><span class="line">click_input.click()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line">bro.quit()</span><br></pre></td></tr></table></figure>



<p>可视化输入账号</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> selenium</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.edge.options <span class="keyword">import</span> Options</span><br><span class="line"><span class="comment"># 无可视化界面设置 #</span></span><br><span class="line">edge_options = Options()</span><br><span class="line"><span class="comment"># # 使用无头模式</span></span><br><span class="line"><span class="comment"># edge_options.add_argument(&#x27;--headless&#x27;)</span></span><br><span class="line"><span class="comment"># # 禁用GPU，防止无头模式出现莫名的BUG</span></span><br><span class="line"><span class="comment"># edge_options.add_argument(&#x27;--disable-gpu&#x27;)</span></span><br><span class="line"><span class="comment"># 将参数传给浏览器</span></span><br><span class="line">bro = webdriver.Edge(options=edge_options)</span><br><span class="line">bro.get(<span class="string">&#x27;https://qzone.qq.com/&#x27;</span>)</span><br><span class="line">bro.switch_to.frame(<span class="string">&#x27;login_frame&#x27;</span>)</span><br><span class="line">click_input=bro.find_element(By.ID,value=<span class="string">&#x27;switcher_plogin&#x27;</span>)<span class="comment"># 定位后面是id的属性值</span></span><br><span class="line">click_input.click()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line">username=bro.find_element(By.ID,value=<span class="string">&#x27;u&#x27;</span>)</span><br><span class="line">username.send_keys(<span class="string">&#x27;3445883193&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line">bro.quit()</span><br></pre></td></tr></table></figure>

<p>然后规避检测的代码如下</p>
<p>再次实现qq登陆的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> selenium</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.edge.options <span class="keyword">import</span> Options</span><br><span class="line"><span class="keyword">from</span> msedge.selenium_tools <span class="keyword">import</span> EdgeOptions</span><br><span class="line"><span class="keyword">from</span> msedge.selenium_tools <span class="keyword">import</span> Edge</span><br><span class="line">edge_options = Options()</span><br><span class="line">edge_options.use_chromium = <span class="literal">True</span></span><br><span class="line">edge_options.add_argument(<span class="string">&#x27;--disable-blink-features=AutomationControlled&#x27;</span>)</span><br><span class="line"><span class="comment"># # 使用无头模式</span></span><br><span class="line"><span class="comment"># edge_options.add_argument(&#x27;--headless&#x27;)</span></span><br><span class="line"><span class="comment"># # 禁用GPU，防止无头模式出现莫名的BUG</span></span><br><span class="line"><span class="comment"># edge_options.add_argument(&#x27;--disable-gpu&#x27;)</span></span><br><span class="line"><span class="comment"># 将参数传给浏览器</span></span><br><span class="line">bro = webdriver.Edge(options=edge_options)</span><br><span class="line">bro.get(<span class="string">&#x27;https://qzone.qq.com/&#x27;</span>)</span><br><span class="line">bro.switch_to.frame(<span class="string">&#x27;login_frame&#x27;</span>)</span><br><span class="line">click_input=bro.find_element(By.ID,value=<span class="string">&#x27;switcher_plogin&#x27;</span>)<span class="comment"># 定位后面是id的属性值</span></span><br><span class="line">click_input.click()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line">username=bro.find_element(By.ID,value=<span class="string">&#x27;u&#x27;</span>)</span><br><span class="line">username.send_keys(<span class="string">&#x27;3445883193&#x27;</span>)</span><br><span class="line">password=bro.find_element(By.ID,value=<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">password.send_keys(<span class="string">&#x27;wei3588559&#x27;</span>)</span><br><span class="line">click_btm=bro.find_element(By.ID,value=<span class="string">&#x27;login_button&#x27;</span>)</span><br><span class="line">click_btm.click()</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line">bro.quit()</span><br></pre></td></tr></table></figure>

<p>每次把</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> selenium</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.edge.options <span class="keyword">import</span> Options</span><br><span class="line"><span class="keyword">from</span> msedge.selenium_tools <span class="keyword">import</span> EdgeOptions</span><br><span class="line"><span class="keyword">from</span> msedge.selenium_tools <span class="keyword">import</span> Edge</span><br><span class="line">edge_options = Options()</span><br><span class="line">edge_options.use_chromium = <span class="literal">True</span></span><br><span class="line">edge_options.add_argument(<span class="string">&#x27;--disable-blink-features=AutomationControlled&#x27;</span>)</span><br><span class="line"><span class="comment"># # 使用无头模式</span></span><br><span class="line">edge_options.add_argument(<span class="string">&#x27;--headless&#x27;</span>)</span><br><span class="line"><span class="comment"># 禁用GPU，防止无头模式出现莫名的BUG</span></span><br><span class="line">edge_options.add_argument(<span class="string">&#x27;--disable-gpu&#x27;</span>)</span><br><span class="line"><span class="comment"># 将参数传给浏览器</span></span><br><span class="line">bro = webdriver.Edge(options=edge_options)</span><br></pre></td></tr></table></figure>

<p>复制在开头就可以</p>
<p>进行12306的模拟登录</p>
<p>​	识别<img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104114755203.png" alt="image-20240104114755203"></p>
<p>这个的模拟登录的话</p>
<p>需要使用超级鹰9004</p>
<p>这样的就可以使用超级硬的<img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104115245214.png" alt="image-20240104115245214"></p>
<p>流程 ：</p>
<ol>
<li></li>
</ol>
<p>使用selenium打开登录界面</p>
<ol start="2">
<li><p>对当前打开的selenium进行截图，整张页面</p>
</li>
<li><p>对当前图片的局部区域（验证码部分）进行裁剪</p>
<p>好处：将验证码和模拟登陆一一对应 	 	</p>
<p>如果直接对图片src属性的链接获得图片进行访问的话</p>
<p>验证码就不是之前的验证码了</p>
<p>验证码图片就会刷新</p>
<p>4.使用超级鹰</p>
<p>定位位置的时候需要使用</p>
<p>location需要pillow</p>
<p>pip install pillow</p>
</li>
</ol>
<p>然后确定坐标</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104121646942.png" alt="image-20240104121646942"></p>
<p>第一步定位带img标签的位置</p>
<p>第二部获得左上角坐标的位置</p>
<p>第三步获取长宽</p>
<p>这两步返回的都是元组</p>
<p>然后就可以获取到位置了</p>
<p>再导入</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104121932028.png" alt="image-20240104121932028">Image对象</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104121957894.png" alt="image-20240104121957894"></p>
<p>crop根据指定位置进行裁剪</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104124907941.png" alt="image-20240104124907941"></p>
<p>这样就可以获取到图片了</p>
<p>就会返回对应的坐标</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104125405282.png" alt="image-20240104125405282"></p>
<p>然后对验证码进行点击</p>
<p>然后导入动作链</p>
<h4 id="scrapy框架"><a href="#scrapy框架" class="headerlink" title="scrapy框架"></a>scrapy框架</h4><p>什么是框架？</p>
<p>就是集成 了很多功能并且具有很强的通用型的一个项目模板。</p>
<p>项目的半成品</p>
<p>如何学习框架？</p>
<p>专门学习框架封装的各种功能的详细用法</p>
<p>什么是scrapy？</p>
<p>爬虫中封装好的一个明星框架。</p>
<p>具有的功能强大</p>
<p>了解封装了哪些功能</p>
<p>功能？</p>
<p>1.高性能的持久化存储。</p>
<p>2.异步数据的同步下载</p>
<p>3.封装了高性能的数据解析</p>
<p>4.分布式</p>
<h6 id="scrapy的基本使用"><a href="#scrapy的基本使用" class="headerlink" title="scrapy的基本使用"></a>scrapy的基本使用</h6><p>环境的安装：</p>
<p>pip install scrapy</p>
<p>我的就直接安装成功了</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104131202387.png" alt="image-20240104131202387"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104131320347.png" alt="image-20240104131320347"></p>
<p>前面几个模块也要安装</p>
<p>我的直接在pycharm上安装了</p>
<p>使用流程</p>
<p>1.创建工程</p>
<p>需要在终端中执行</p>
<p>scrapy startproject 项目名称</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104132214522.png" alt="image-20240104132214522"></p>
<p>目录文件</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104132432587.png" alt="image-20240104132432587"></p>
<p>spiders是爬虫文件夹</p>
<p>里卖弄需要方爬虫文件</p>
<p>spiders子目录创建一个爬虫文件</p>
<p>先进入工程文件</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104132920408.png" alt="image-20240104132920408"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104133009742.png" alt="image-20240104133009742"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104133044962.png" alt="image-20240104133044962"></p>
<p>这样就成功创建了一个名字为spiderName的爬虫文件</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104133209740.png" alt="image-20240104133209740"></p>
<p>然后就可以进行相关代码的编写</p>
<p>如果所有的工程代码都完成了</p>
<p>然后就可以执行工程代码：scrapy crawl +那个创建的名称</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104134628414.png" alt="image-20240104134628414"></p>
<p>爬虫文件代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SpidernameSpider</span>(scrapy.Spider):</span><br><span class="line">    name = <span class="string">&quot;spiderName&quot;</span><span class="comment">#爬虫文件名称：爬虫源文件的唯一标识</span></span><br><span class="line">    <span class="comment">#一般下面的这一项会被注释掉</span></span><br><span class="line">    <span class="comment">#allowed_domains = [&quot;www.baidu.com&quot;]#允许的域名 ：限制start——url里的哪些url可以发送</span></span><br><span class="line">    start_urls = [<span class="string">&quot;https://www.baidu.com&quot;</span>,<span class="string">&quot;https://www.taobao.com&quot;</span>]<span class="comment">#起始的url列表：该列表的url会被scrapy自动进行请求的发送</span></span><br><span class="line"><span class="comment">#用做与数据解析：   response参数表示的就是请求成功后对应的响应对象</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">self, response</span>):</span><br><span class="line">        <span class="built_in">print</span>(response)<span class="comment">#z这样就会调用两次回复两个response因为上面有两个url</span></span><br></pre></td></tr></table></figure>

<p>然后执行以后</p>
<p>发现打印并不是response而是日志</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104134811313.png" alt="image-20240104134811313"></p>
<p>因为配置文件</p>
<p>需要把<img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104135024813.png" alt="image-20240104135024813"></p>
<p>robots</p>
<p>君子协议爬不到的需要改为False</p>
<p>再次执行命令 </p>
<p>发现</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104162655206.png" alt="image-20240104162655206"></p>
<p>还有日志信息</p>
<p>我们可以添加参数不打印日志</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104163051906.png" alt="image-20240104163051906"><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104163223983.png" alt="image-20240104163223983"></p>
<p>但是程序如果有错误的话就不会显示任何东西</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104163329323.png" alt="image-20240104163329323"></p>
<p>在配置文件中可以</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104163329323-17043572242651.png"></p>
<p>这样就可以只显示错误的日志</p>
<p> <img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104172149517.png" alt="image-20240104172149517"></p>
<p>xpath发布会是列表</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104172507136.png" alt="image-20240104172507136"></p>
<p>因为span下面还有标签所以获取到文本需要使用text（）并且它返回的是一个列表这里的xpath返回的是一个对象，如果想把它变成字符串的话就需要使用extract这个方法</p>
<p>如果列表是用来这个方法的话</p>
<p>返回的是一个列表</p>
<p>所以我们需要使用join的方法四列表转为字符串</p>
<p>或者</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104172930705.png" alt="image-20240104172930705"></p>
<p>保证列表中只有一个元素话就可以使用这个方法 </p>
<p>scrapy实现数据解析</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104173020746.png" alt="image-20240104173020746"></p>
<p>scrapy实现持久化存储</p>
<p>1.基于终端指令</p>
<p>-要求只可以将parse方法的返回值存储到本地的文本文件中</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104173401610.png" alt="image-20240104173401610"></p>
<p>这样写</p>
<p>再在终端里面这写</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104173506980.png" alt="image-20240104173506980"></p>
<p>注意持久化存储</p>
<p>只能有</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104173555585.png" alt="image-20240104173555585"></p>
<p>一般就是csv或者json</p>
<p>演示的操作</p>
<p>如果爬取这个</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104182934971.png" alt="image-20240104182934971"></p>
<p>代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SpidernameSpider</span>(scrapy.Spider):</span><br><span class="line">    name = <span class="string">&quot;spiderName&quot;</span><span class="comment">#爬虫文件名称：爬虫源文件的唯一标识</span></span><br><span class="line">    <span class="comment">#一般下面的这一项会被注释掉</span></span><br><span class="line">    <span class="comment">#allowed_domains = [&quot;www.baidu.com&quot;]#允许的域名 ：限制start——url里的哪些url可以发送</span></span><br><span class="line">    start_urls = [<span class="string">&quot;https://so.gushiwen.cn/guwen/book_46653FD803893E4F7F702BCF1F7CCE17.aspx&quot;</span>]<span class="comment">#起始的url列表：该列表的url会被scrapy自动进行请求的发送</span></span><br><span class="line"><span class="comment">#用做与数据解析：   response参数表示的就是请求成功后对应的响应对象</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">self, response</span>):</span><br><span class="line">      njr=response.xpath(<span class="string">&#x27;/html/body/div[2]/div[1]/div[2]/div[1]/p//text()&#x27;</span>).extract()</span><br><span class="line">      con=<span class="string">&#x27;&#x27;</span>.join(njr)</span><br><span class="line">      <span class="comment"># print(con)</span></span><br><span class="line">      <span class="keyword">return</span> con</span><br></pre></td></tr></table></figure>

<p>执行的命令</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104183047739.png" alt="image-20240104183047739"></p>
<p>好处</p>
<p>简洁高效</p>
<p>缺点</p>
<p>局限比较强</p>
<p>2.基于管道的方法 </p>
<p>操作复杂</p>
<p>编码流程</p>
<p>1.数据解析</p>
<p>2.在item类中定义相关的属性</p>
<p>items.py里面</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104174108684.png" alt="image-20240104174108684"></p>
<p>把需要储存的这样写</p>
<p>根据上面的例子</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104183239871.png" alt="image-20240104183239871"></p>
<p>3.将解析的数据封装到item类型对象</p>
<p>4.将item类的对象提交给管道进行持久化存储</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104183421900.png" alt="image-20240104183421900"></p>
<p>管道类中process——item 将接受到item对象进行存储</p>
<p>5.在配置文件中手动开启管道</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104190710575.png" alt="image-20240104190710575"></p>
<p>里面的300表表示优先级，越小优先级越高	</p>
<p>实践走起</p>
<p>项目里的</p>
<p>njr1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="comment">#基于管道的持久化存储的操作</span></span><br><span class="line"><span class="comment">#导入item</span></span><br><span class="line"><span class="keyword">from</span> njr.items <span class="keyword">import</span> NjrItem</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Njr1Spider</span>(scrapy.Spider):</span><br><span class="line">    name = <span class="string">&quot;njr1&quot;</span></span><br><span class="line">    <span class="comment"># allowed_domains = [&quot;www.baidu.com&quot;]</span></span><br><span class="line">    start_urls = [<span class="string">&quot;https://so.gushiwen.cn/guwen/book_46653FD803893E4F7F702BCF1F7CCE17.aspx&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">self, response</span>):</span><br><span class="line">        text = response.xpath(<span class="string">&#x27;/html/body/div[2]/div[1]/div[2]/div[1]/p//text()&#x27;</span>).extract()</span><br><span class="line">        con = <span class="string">&#x27;&#x27;</span>.join(text)</span><br><span class="line">        <span class="built_in">print</span>(con)</span><br><span class="line">        <span class="comment"># pass</span></span><br><span class="line">        <span class="comment">#实列话引入的对象</span></span><br><span class="line">        item=NjrItem()</span><br><span class="line">        <span class="comment">#将item的数据封装到</span></span><br><span class="line">        item[<span class="string">&#x27;con&#x27;</span>]=con</span><br><span class="line"><span class="comment">#将item提交给管道</span></span><br><span class="line">        <span class="keyword">yield</span> item</span><br></pre></td></tr></table></figure>

<p>面试题：</p>
<p>将爬到的数据一份存在本地一份存在数据库，如何实现？</p>
<p>使用管道</p>
<p>实现的方法：</p>
<p>在管道文件中再定义一个类</p>
<p>现在管道文件中</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104192015598.png" alt="image-20240104192015598"></p>
<p>导入库</p>
<p>管道的代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Define your item pipelines here</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Don&#x27;t forget to add your pipeline to the ITEM_PIPELINES setting</span></span><br><span class="line"><span class="comment"># See: https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># useful for handling different item types with a single interface</span></span><br><span class="line"><span class="keyword">from</span> itemadapter <span class="keyword">import</span> ItemAdapter</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NjrPipeline</span>:</span><br><span class="line">    fp=<span class="literal">None</span></span><br><span class="line">    <span class="comment">#重写一个父类的一个方法：该方法只在开始怕从的时候被调用一次</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">open_spider</span>(<span class="params">self,spider</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;开始爬虫&#x27;</span>)</span><br><span class="line">        self.fp=<span class="built_in">open</span>(<span class="string">&#x27;./三国1scary .txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_item</span>(<span class="params">self, item, spider</span>):</span><br><span class="line">        con=item[<span class="string">&#x27;con&#x27;</span>]<span class="comment">#接受值</span></span><br><span class="line">        <span class="comment">#进行存储</span></span><br><span class="line">        self.fp.write(con)</span><br><span class="line">        <span class="keyword">return</span> item</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">close_spider</span>(<span class="params">self,spider</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;over&#x27;</span>)</span><br><span class="line">        self.fp.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> item</span><br><span class="line"><span class="comment">#将一份存在数据库中</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">mysqlPipeline</span>():</span><br><span class="line">    <span class="comment">#可以把连接数据库放到这里</span></span><br><span class="line">    conn=<span class="literal">None</span></span><br><span class="line">    cursor=<span class="literal">None</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">open_spider</span>(<span class="params">self,spider</span>):<span class="comment">#这个函数只会在开始的时候执行</span></span><br><span class="line">        self.conn=pymysql.connect(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">3306</span>,user=<span class="string">&#x27;root&#x27;</span>,password=<span class="string">&#x27;123456&#x27;</span>,db=<span class="string">&#x27;pycharm&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_item</span>(<span class="params">self, item, spider</span>):</span><br><span class="line">        self.conn.cursor()</span><br><span class="line">        self.cursor.execute(<span class="string">&#x27;insert into 111 value(&quot;%s&quot;)%(con)&#x27;</span>)</span><br><span class="line">        self.conn.commit()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">close_spider</span>(<span class="params">self,spider</span>):</span><br><span class="line">        self.cursor.close()</span><br><span class="line">        self.conn.close()</span><br></pre></td></tr></table></figure>

<p>配置文件中还需要添加</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240104194654525.png" alt="image-20240104194654525"></p>
<p>算了放弃了</p>
<p>然后就是</p>
<p>yield scrapy.Request(url,callback&#x3D;self.)</p>
<p>对解析出的url在进行解析数据</p>
<h5 id="scrapy图片数据的爬取"><a href="#scrapy图片数据的爬取" class="headerlink" title="scrapy图片数据的爬取"></a>scrapy图片数据的爬取</h5><p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240106173027434.png" alt="image-20240106173027434"></p>
<p>实践</p>
<p>发现请求的数据是none原因是因为</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240106173651679.png" alt="image-20240106173651679"></p>
<p>src2是伪属性</p>
<p>如果舒勇src2的话</p>
<p>请求的页面不会显示在前端也不会有显示</p>
<p>发现大部分的图片是src2</p>
<p>发现只有当前页面显示的src是src</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240106174009621.png" alt="image-20240106174009621"></p>
<p>没有显示出来的是src2</p>
<p>只有真正src属性才可以显示在有可视化界面</p>
<p>因为scrapy请求没有可视化界面 所以就不可以获取到</p>
<p>只要把src换成src2才可以</p>
<p>要使用为属性 </p>
<p>如果是图片的话</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240106174609652.png" alt="image-20240106174609652"></p>
<p>管道类的这个就不能在使用了</p>
<p>用imagesPipeline</p>
<p>上面的问题我在爬站长之家的时候遇到了</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240106180902317.png" alt="image-20240106180902317"></p>
<p>懒加载</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/03/%E5%A4%9A%E7%BA%BF%E7%A8%8B&%E5%AF%B9%E8%BF%9B%E7%A8%8B&%E5%BC%82%E6%AD%A5IO/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/03/%E5%A4%9A%E7%BA%BF%E7%A8%8B&%E5%AF%B9%E8%BF%9B%E7%A8%8B&%E5%BC%82%E6%AD%A5IO/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-03 17:58:18 / 修改时间：18:06:36" itemprop="dateCreated datePublished" datetime="2024-01-03T17:58:18+08:00">2024-01-03</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="多线程-对进程-异步IO"><a href="#多线程-对进程-异步IO" class="headerlink" title="多线程&amp;对进程&amp;异步IO"></a>多线程&amp;对进程&amp;异步IO</h1><p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103175827289.png" alt="image-20240103175827289"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103175915904.png" alt="image-20240103175915904"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103180001817.png" alt="image-20240103180001817"></p>
<p>bound就是受限的意思</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103180108441.png" alt="image-20240103180108441"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103180518988.png" alt="image-20240103180518988"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103180538082.png" alt="image-20240103180538082"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103180635053.png" alt="image-20240103180635053"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/03/python%E9%AB%98%E7%BA%A7%E8%BF%9B%E9%98%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/03/python%E9%AB%98%E7%BA%A7%E8%BF%9B%E9%98%B6/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-03 12:20:50 / 修改时间：17:49:40" itemprop="dateCreated datePublished" datetime="2024-01-03T12:20:50+08:00">2024-01-03</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="python高级进阶"><a href="#python高级进阶" class="headerlink" title="python高级进阶"></a>python高级进阶</h1><h4 id="装饰器的基本概念"><a href="#装饰器的基本概念" class="headerlink" title="装饰器的基本概念"></a>装饰器的基本概念</h4><p>用来装饰其他函数的，即为其他函数添加特定功能</p>
<p>这就是装饰器</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103120608940.png" alt="image-20240103120608940"></p>
<p>两个原则</p>
<p>-》不能修改被装饰的函数的源码</p>
<p>-》不能修改被装饰函数的调用方式</p>
<h6 id="掌握的概念"><a href="#掌握的概念" class="headerlink" title="掌握的概念"></a>掌握的概念</h6><p>函数就是变量</p>
<p>即可以直接被调用，也可以当作变量赋值</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103121134716.png" alt="image-20240103121134716"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103121541795.png" alt="image-20240103121541795"></p>
<p>为什么没有报错</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103121728588.png" alt="image-20240103121728588"></p>
<p>这样就会报错</p>
<p>第一看程序向下执行</p>
<p>看见函数就保存下来</p>
<p>高阶函数</p>
<p>条件</p>
<p>接受函数名作为形参</p>
<p>返回值包含函数名</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103122032985.png" alt="image-20240103122032985"></p>
<p>打印foo的地址</p>
<p>就可以把上面的代码理解为装饰器</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103122248649.png" alt="image-20240103122248649"></p>
<p>运行了装饰的含函数并且添加一些功能性语句</p>
<p>统计函数运行诗经的装饰器</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103122503798.png" alt="image-20240103122503798"></p>
<p>但这不是装饰器因为不符合被调用方式</p>
<p>改变了foo的调用方式说明不是一个装饰器</p>
<p>可以这样</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103122943563.png" alt="image-20240103122943563"></p>
<p>调用高阶函数返回函数名但是后面及时的不操作完成不了</p>
<h6 id="嵌套函数"><a href="#嵌套函数" class="headerlink" title="嵌套函数"></a>嵌套函数</h6><p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103130231298.png" alt="image-20240103130231298"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103130915126.png" alt="image-20240103130915126"></p>
<p>这样就是嵌套函数</p>
<p>把timer函数重新赋给foo</p>
<p>然后调用foo（）就会调用timer函数里面会调用foo</p>
<p>然后就会直接的简化</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103131636153.png" alt="image-20240103131636153"></p>
<h6 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h6><p>消息队列</p>
<p>EVENT事件对象</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/02/%E5%8D%8F%E7%A8%8B+asyncio+%E5%BC%82%E6%AD%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/02/%E5%8D%8F%E7%A8%8B+asyncio+%E5%BC%82%E6%AD%A5/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-01-02 17:10:57" itemprop="dateCreated datePublished" datetime="2024-01-02T17:10:57+08:00">2024-01-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-03 10:31:44" itemprop="dateModified" datetime="2024-01-03T10:31:44+08:00">2024-01-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="协程-asyncio-异步"><a href="#协程-asyncio-异步" class="headerlink" title="协程+asyncio+异步"></a>协程+asyncio+异步</h1><p>​	-异步非堵塞，asyncio</p>
<p>​	-tornado,fastapi,django 3.x asgi,aiohttp都在异步-&gt;提高性能</p>
<p>部分：</p>
<p>1.协程</p>
<p>2.asyncio模块进行异步异步编程</p>
<h4 id="1、协程"><a href="#1、协程" class="headerlink" title="1、协程"></a>1、协程</h4><p>不是计算机提供的，而是程序员人为创造出来的</p>
<p> 用一个线程实现看代码块相互切换执行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fu</span>():</span><br><span class="line">   <span class="built_in">print</span>(<span class="number">1</span>)</span><br><span class="line">   </span><br><span class="line">   <span class="built_in">print</span>(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fu2</span>():</span><br><span class="line">	pritn(<span class="number">3</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">print</span>(<span class="number">4</span>)</span><br><span class="line">fu()</span><br><span class="line">fu2()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>上述的代码正常就会按照顺序执行</p>
<p>如果协程的话可能就会 一会执行fu里面的代码一会fu2里面的代码</p>
<p>实现协程的方法：</p>
<p>1：greenlet，第三方模块，早期的模块</p>
<p>2：yield关键字</p>
<p>3：asyncio装饰器（py3.4）</p>
<p>4:async，await关键字（py3.5)</p>
<h4 id="1-1greenlet实现协程："><a href="#1-1greenlet实现协程：" class="headerlink" title="1.1greenlet实现协程："></a>1.1greenlet实现协程：</h4><p>需要安装模块</p>
<p>下载即可</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102172553823.png" alt="image-20240102172553823"></p>
<p>例子</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102173417773.png" alt="image-20240102173417773"></p>
<p>输出结果</p>
<p>1324</p>
<h4 id="1-2-通过yield关键字"><a href="#1-2-通过yield关键字" class="headerlink" title="1.2.通过yield关键字"></a>1.2.通过yield关键字</h4><p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102173701792.png" alt="image-20240102173701792"></p>
<p>先进入f1</p>
<p>然后yield关键字进入f2</p>
<p>然后输出34</p>
<p>然后返回输出2</p>
<h4 id="1-3asyncio"><a href="#1-3asyncio" class="headerlink" title="1.3asyncio"></a>1.3asyncio</h4><p>在python3.4以后的版本</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102174145350.png" alt="image-20240102174145350"></p>
<p>俗话说就是：</p>
<p>这个函数随机执行里面碰到阻碍的话再去换一个</p>
<p>注意：遇到IO耗时操作的时候，会自动化切换tasks里面的其他操作</p>
<p>​	如果里面换成网络的Io请求：下载一个视频</p>
<p>他会先给网络发送请求</p>
<p>然后在切换到其他的任务</p>
<p>这样的下载图片的任务两秒中就可以完成了</p>
<p>下载两张花费了一张的时间</p>
<h4 id="1-4：async-await关键字"><a href="#1-4：async-await关键字" class="headerlink" title="1.4：async &amp;await关键字"></a>1.4：async &amp;await关键字</h4><p>和上免得操作一样就是简化代码了</p>
<p>更改的地方</p>
<p>不需要 用到熏染器了</p>
<p>把yield from可以换成await</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102181107001.png" alt="image-20240102181107001"></p>
<p>也能能完成协程</p>
<p>一般使用greenlet和async&amp;await关键字</p>
<h4 id="意义："><a href="#意义：" class="headerlink" title="意义："></a>意义：</h4><p>利用一个线程，如果遇到IO等待的时间，线程不会傻等，利用空闲的时间再去干点其他的事情</p>
<p>普通的方法下载图片：</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102181636988.png" alt="image-20240102181636988"></p>
<p>及优化后 的代码</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102181745898.png" alt="image-20240102181745898"></p>
<h4 id="3-异步编程"><a href="#3-异步编程" class="headerlink" title="3.异步编程"></a>3.异步编程</h4><h5 id="3-1时间循环"><a href="#3-1时间循环" class="headerlink" title="3.1时间循环"></a>3.1时间循环</h5><p>理解成一个死循环，去检测并且执行某些代码</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102205341736.png" alt="image-20240102205341736"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102205504764.png" alt="image-20240102205504764"></p>
<p>上手</p>
<p>协程函数，定义函数的时候async def函数名</p>
<p>协程对象，执行协程函数</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102205752641.png" alt="image-20240102205752641"></p>
<p>如果想要运行的话</p>
<p>或者直接</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102205947814.png" alt="image-20240102205947814"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fp</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;666&quot;</span>)</span><br><span class="line">result=fp()</span><br><span class="line"><span class="comment"># loop=asyncio.get_event_loop()#创建循</span></span><br><span class="line"><span class="comment"># loop.run_until_complete(result)</span></span><br><span class="line"><span class="comment"># asyncio.run(result)</span></span><br></pre></td></tr></table></figure>

<p>直接运行协程函数四运行不了的</p>
<p>后面的两种方法都可以执行</p>
<h4 id="3-3await关键字"><a href="#3-3await关键字" class="headerlink" title="3.3await关键字"></a>3.3await关键字</h4><p>await+可等待的对象（协程对象	，future，task对象-&gt;io对象）</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102210743586.png" alt="image-20240102210743586"></p>
<p>遇到io等待两秒钟此时会进行其他的任务</p>
<p>等待结束以后会进行</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102211056590.png" alt="image-20240102211056590"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102211229451.png" alt="image-20240102211229451"></p>
<p>await会继续等，等到结束玩有返回值了才继续往下走</p>
<p>上面的代码，等待对象的得到结果才继续往下走</p>
<p>为什么要await？性能也不提高</p>
<p>因为如果下一步需要依赖这一步await的结果就需要await，依然也会切到其他的任务去执行（其他的任务指的是task对象的其他任务），上面就相当于一i个任务，需要等待response执行完才进行下一个</p>
<h6 id="3-4Task对象3-5"><a href="#3-4Task对象3-5" class="headerlink" title="3.4Task对象3.5"></a>3.4Task对象3.5</h6><p>​	在事件循环中添加多个任务</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102212018687.png" alt="image-20240102212018687"></p>
<p>示例一</p>
<h6 id="3-5asyncioFuture对象"><a href="#3-5asyncioFuture对象" class="headerlink" title="3.5asyncioFuture对象"></a>3.5asyncioFuture对象</h6><p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103102341838.png" alt="image-20240103102341838"></p>
<h6 id="3-6concurrent，futures-Future对象"><a href="#3-6concurrent，futures-Future对象" class="headerlink" title="3.6concurrent，futures.Future对象"></a>3.6concurrent，futures.Future对象</h6><p>使用线程池。进程池实现异步时的操作</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103102734865.png" alt="image-20240103102734865"></p>
<p>最后的会以下全执行完</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103103008267.png" alt="image-20240103103008267"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103103142288.png" alt="image-20240103103142288"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/02/%E9%AA%8C%E8%AF%81%E7%A0%81%E8%AF%86%E5%88%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/02/%E9%AA%8C%E8%AF%81%E7%A0%81%E8%AF%86%E5%88%AB/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-01-02 10:08:26" itemprop="dateCreated datePublished" datetime="2024-01-02T10:08:26+08:00">2024-01-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-03 19:10:54" itemprop="dateModified" datetime="2024-01-03T19:10:54+08:00">2024-01-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="验证码识别"><a href="#验证码识别" class="headerlink" title="验证码识别"></a>验证码识别</h1><p>验证码和爬虫的爱恨情仇？</p>
<p>反爬机制;验证码</p>
<p>如果爬取某些用户的一些信息</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102101127227.png" alt="image-20240102101127227"></p>
<p>需要录入验证码</p>
<p>需要进行处理</p>
<p>识别图片中的数据，模拟登录操作</p>
<p>识别验证码的操作</p>
<p>1人工肉眼识别‘：（不推荐）</p>
<p>2第三方自动识别：（推荐）</p>
<p>​	-云打码：好好好已经倒闭了</p>
<p>​	-超级鹰：		这个可以</p>
<p>实战;识别古诗文王登录页面的验证码。</p>
<p>使用打码平台的验证码的编码流程;</p>
<p>-加密和验证码进行本地下载</p>
<p>-调用平台的示例代码进行图片数据的识别</p>
<p>实战：</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102105712755.png" alt="image-20240102105712755"></p>
<p>识别古诗文网登录页面的验证码</p>
<p>解题思路：</p>
<p>1.获取页面的源码和图片</p>
<p>2.导入识别验证码代码</p>
<p>3.为了方便封装识别验证码的函数</p>
<p>4.将剩余的验证码封装成一个类</p>
<p>代码详情：识别验证码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">from</span> codeclass <span class="keyword">import</span> Chaojiying_Client</span><br><span class="line"></span><br><span class="line"><span class="comment"># 为了简单封装识别验证码的函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getCodeText</span>(<span class="params">img_path, Codetype</span>):</span><br><span class="line">    chaojiying = Chaojiying_Client(<span class="string">&#x27;chen1978&#x27;</span>, <span class="string">&#x27;wei3588559&#x27;</span>, <span class="string">&#x27;956857&#x27;</span>)  <span class="comment"># 用户中心&gt;&gt;软件ID 生成一个替换 96001</span></span><br><span class="line">    im = <span class="built_in">open</span>(img_path, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">    result = chaojiying.PostPic(im, Codetype)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;https://so.gushiwen.cn/user/login.aspx?from=http://so.gushiwen.cn/user/collect.aspx&#x27;</span></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">page_content = requests.get(url=url, headers=header).text</span><br><span class="line">tree = etree.HTML(page_content)</span><br><span class="line">img_url = <span class="string">&#x27;https://so.gushiwen.cn&#x27;</span> + tree.xpath(<span class="string">&#x27;//*[@id=&quot;imgCode&quot;]/@src&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">img = requests.get(url=img_url, headers=header).content</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;验证码.jpg&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(img)  <span class="comment"># 将验证码图片保存在本地</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用打码平台</span></span><br><span class="line">code_txt = getCodeText(<span class="string">&#x27;验证码.jpg&#x27;</span>, <span class="number">1004</span>)</span><br><span class="line"><span class="built_in">print</span>(code_txt[<span class="string">&#x27;pic_str&#x27;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2codeclass的类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Chaojiying_Client</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, username, password, soft_id</span>):</span><br><span class="line">        self.username = username</span><br><span class="line">        password =  password.encode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">        self.password = md5(password).hexdigest()</span><br><span class="line">        self.soft_id = soft_id</span><br><span class="line">        self.base_params = &#123;</span><br><span class="line">            <span class="string">&#x27;user&#x27;</span>: self.username,</span><br><span class="line">            <span class="string">&#x27;pass2&#x27;</span>: self.password,</span><br><span class="line">            <span class="string">&#x27;softid&#x27;</span>: self.soft_id,</span><br><span class="line">        &#125;</span><br><span class="line">        self.headers = &#123;</span><br><span class="line">            <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;Keep-Alive&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)&#x27;</span>,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">PostPic</span>(<span class="params">self, im, codetype</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        im: 图片字节</span></span><br><span class="line"><span class="string">        codetype: 题目类型 参考 http://www.chaojiying.com/price.html</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">&#x27;codetype&#x27;</span>: codetype,</span><br><span class="line">        &#125;</span><br><span class="line">        params.update(self.base_params)</span><br><span class="line">        files = &#123;<span class="string">&#x27;userfile&#x27;</span>: (<span class="string">&#x27;ccc.jpg&#x27;</span>, im)&#125;</span><br><span class="line">        r = requests.post(<span class="string">&#x27;http://upload.chaojiying.net/Upload/Processing.php&#x27;</span>, data=params, files=files, headers=self.headers)</span><br><span class="line">        <span class="keyword">return</span> r.json()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">PostPic_base64</span>(<span class="params">self, base64_str, codetype</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        im: 图片字节</span></span><br><span class="line"><span class="string">        codetype: 题目类型 参考 http://www.chaojiying.com/price.html</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">&#x27;codetype&#x27;</span>: codetype,</span><br><span class="line">            <span class="string">&#x27;file_base64&#x27;</span>:base64_str</span><br><span class="line">        &#125;</span><br><span class="line">        params.update(self.base_params)</span><br><span class="line">        r = requests.post(<span class="string">&#x27;http://upload.chaojiying.net/Upload/Processing.php&#x27;</span>, data=params, headers=self.headers)</span><br><span class="line">        <span class="keyword">return</span> r.json()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ReportError</span>(<span class="params">self, im_id</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        im_id:报错题目的图片ID</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">&#x27;id&#x27;</span>: im_id,</span><br><span class="line">        &#125;</span><br><span class="line">        params.update(self.base_params)</span><br><span class="line">        r = requests.post(<span class="string">&#x27;http://upload.chaojiying.net/Upload/ReportError.php&#x27;</span>, data=params, headers=self.headers)</span><br><span class="line">        <span class="keyword">return</span> r.json()</span><br></pre></td></tr></table></figure>

<p>将超级鹰给出的代码分别封装就可以</p>
<p>我们也可以通过参数传递路径和类型</p>
<p>例如：传入img_path和Codetype</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">getCodeText</span>(<span class="params">img_path, Codetype</span>):</span><br><span class="line">    chaojiying = Chaojiying_Client(<span class="string">&#x27;chen1978&#x27;</span>, <span class="string">&#x27;wei3588559&#x27;</span>, <span class="string">&#x27;956857&#x27;</span>)  <span class="comment"># 用户中心&gt;&gt;软件ID 生成一个替换 96001</span></span><br><span class="line">    im = <span class="built_in">open</span>(img_path, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">    result = chaojiying.PostPic(im, Codetype)</span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>

<p>识别的验证码可能会有一些误差</p>
<p>实战：模拟登录</p>
<p>​			-爬取基于某些用户的个人信息</p>
<p>​			-登录成功后才能进行数据分析</p>
<p>需求：</p>
<p>对人人网进行模拟登录</p>
<p>没有网站的了，讲一下思路吧；</p>
<p>1.开始登录页面需要验证码和账号密码</p>
<p>2.正常登录后，查看数据包，有个login的包，已更改就是登录的包</p>
<p>3.是个post的请求里面的data携带账号密码和验证码</p>
<p>4.我们就可以先发起个get请求到登录页面，然后获取账号密码和验证码</p>
<p>5.然后发起post请求里面的参数验证修改</p>
<p>6.然后对页面的数据进行持久化存储</p>
<p>7.注意有可能存储的不是页面源码我们可以在判断一下看以下页面的响应码</p>
<p>这么写</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102121732817.png" alt="image-20240102121732817"></p>
<h4 id="模拟cookie登录"><a href="#模拟cookie登录" class="headerlink" title="模拟cookie登录"></a>模拟cookie登录</h4><p>爬取当前用户相关信息</p>
<p>爬取个人主页对应的页面数据</p>
<p>基于cookie的操作</p>
<p>http，https都是无状态协议</p>
<p>如果我们在紧接上部登录以后在访问简介获取简介的源码数据的话</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102130154957.png" alt="image-20240102130154957"></p>
<p>这段代码可能返回的源码数据可能不是简介的源码数据</p>
<p>可能是登录的源码的数据 </p>
<p>因为http是无状态的所以不会记录上一部分登录成功的部分</p>
<p>导致第二次登录 的请求，服务器并不知道是否处于登录状态</p>
<p>cookie记录客户端的状态</p>
<p>浏览器的包</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102130650459.png" alt="image-20240102130650459"></p>
<p>所以我们也可以伪造cookie</p>
<p>1手动cookie配置(通用行不强)</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102130825556.png" alt="image-20240102130825556"></p>
<p>2自动处理</p>
<p>cookie的来源？</p>
<p>在我们的登录的时候的响应包</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102131056840.png" alt="image-20240102131056840"></p>
<p>服务器会给我们创建cookie</p>
<p>用到session会话对象：</p>
<p>​	-作用：可以请求的发送和requests一样</p>
<p>​	-如果请求的过程中产生了cookie，则该cookie会被自动储存在sessin中</p>
<p>步骤</p>
<p>1.使用session对像金总模拟post请求的发送(cookie会被自动储存在session中)</p>
<p>2.session对象对个人主页对应get亲贵发送（携带了cookie）</p>
<p>创建session对象:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session=requests.Session()</span><br></pre></td></tr></table></figure>

<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102131919688.png" alt="image-20240102131919688"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102131947670.png" alt="image-20240102131947670"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102132014868.png" alt="image-20240102132014868"></p>
<h6 id="使用代理ip的相关操作"><a href="#使用代理ip的相关操作" class="headerlink" title="使用代理ip的相关操作"></a>使用代理ip的相关操作</h6><p>-你的ip访问次数过多</p>
<p>-访问超过了单位时间的次数</p>
<p>用来破解封ip的反爬机制</p>
<p>什么代理:</p>
<p>​		-代理服务器，请求先到代理服务器再去服务器，ip就是代理服务器的</p>
<p>代理的作用：</p>
<p>​		-突破自身ip访问的限制</p>
<p>​		-可以隐藏自身ip免受攻击</p>
<p>代理网站：</p>
<p>​		-快代理</p>
<p>​		-西祠代理</p>
<p>​		-<a target="_blank" rel="noopener" href="http://www.goubanjia.com/">www.goubanjia.com</a></p>
<p>代理的操作</p>
<p>代理ip类型</p>
<p>1.http：应用到http协议对应的url</p>
<p>2.https：应用到https协议对应的url</p>
<p>如果我们要访问</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&#x27;https://www.baidu.com/s?wd=ip&#x27;</span></span><br><span class="line">header=&#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">page_text=requests.get(url=url,headers=header).text</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;ip.html&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(page_text)</span><br></pre></td></tr></table></figure>

<p>就需要https的代理</p>
<p>找到一个免费代理的网站（<a target="_blank" rel="noopener" href="http://www.ip3366.net/">云代理 - 高品质http代理ip供应平台_免费代理IP (ip3366.net)</a>）</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102135610142.png" alt="image-20240102135610142"></p>
<p>如何实现？</p>
<p>在get请求中添加参数proxies的参数</p>
<p>源码如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&#x27;https://www.baidu.com/s?wd=ip&#x27;</span></span><br><span class="line">header=&#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">proxy=&#123;</span><br><span class="line">    <span class="string">&#x27;HTTPS&#x27;</span>:<span class="string">&#x27;117.71.149.139&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">page_text=requests.get(url=url,headers=header,proxies=proxy).text</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;ip.html&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(page_text)</span><br></pre></td></tr></table></figure>

<p>这样就可以设置ip</p>
<p>应用了 代理服务器的ip</p>
<p>还有匿名读</p>
<p>1.透明：服务器知道使用代理，也知道请求对应的可真实 的ip</p>
<p>2.匿名：知道使用代理，不知道真实的ip</p>
<p>3.高匿：不知道使用了代理，也不知道真实的ip</p>
<h3 id="高性能异步爬虫"><a href="#高性能异步爬虫" class="headerlink" title="高性能异步爬虫"></a>高性能异步爬虫</h3><p>目的：</p>
<p>在爬虫中使用异步实现高性能的数据爬取操作。</p>
<p>单线程下使用串行的方式进行数据的发送</p>
<p>例子：如下面的代码一共多个人url，get的请求只会依次的的发送请求，导致了get请求是一个堵塞的方法，如果我们有成百上千的方法的话，那么可能就会执行的很慢就造成了堵塞</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102142502764.png" alt="image-20240102142502764"></p>
<p> 爬取数据的效率比较低</p>
<p>就要使用异步了</p>
<p>异步爬虫的方式：</p>
<p>​			-多进程,多线程（不建议）:</p>
<p>​                    好处：为阻塞的操作单独安排的进程，阻塞操作可以异步操作</p>
<p>​					弊端：无法无限制的开启多线程或者进程如果很多的话会占用cpu的资源</p>
<p>​		-进程池.线程池（适当的使用）：</p>
<p>​				好处：我们可以降低系统对线程或者线程创建和销毁的一个频率从而降低西系统开销</p>
<p>​				弊端：池中线程或者进程的数量是有限的</p>
<p>模拟单线程：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_page</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正在下载：&quot;</span>,<span class="built_in">str</span>)</span><br><span class="line">    time.sleep(<span class="number">2</span>)<span class="comment">#模拟get的阻塞</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;下载成功：&quot;</span>,<span class="built_in">str</span>)</span><br><span class="line">name_list=[<span class="string">&#x27;hututu&#x27;</span>,<span class="string">&#x27;wangchangxhebn&#x27;</span>,<span class="string">&#x27;libai&#x27;</span>,<span class="string">&#x27;zhangfeui0&#x27;</span>]</span><br><span class="line"><span class="comment">#模拟多个url</span></span><br><span class="line">start_time=time.time()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(name_list)):</span><br><span class="line">    get_page(name_list[name])</span><br><span class="line">end_time=time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;%d&quot;</span>%(end_time-start_time))</span><br></pre></td></tr></table></figure>

<p>耗时</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102152027299.png" alt="image-20240102152027299"></p>
<p>基于线程池的方式：</p>
<p>多线程 的操作流程：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> multiprocessing.dummy <span class="keyword">import</span> Pool<span class="comment">#使用线程池的方法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_page</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正在下载：&quot;</span>,<span class="built_in">str</span>)</span><br><span class="line">    time.sleep(<span class="number">2</span>)<span class="comment">#模拟get的阻塞</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;下载成功：&quot;</span>,<span class="built_in">str</span>)</span><br><span class="line">name_list=[<span class="string">&#x27;hututu&#x27;</span>,<span class="string">&#x27;wangchangxhebn&#x27;</span>,<span class="string">&#x27;libai&#x27;</span>,<span class="string">&#x27;zhangfeui0&#x27;</span>]</span><br><span class="line"><span class="comment">#模拟多个url</span></span><br><span class="line">start_time=time.time()</span><br><span class="line"><span class="comment">#实例化pool对象</span></span><br><span class="line">pool=Pool()</span><br><span class="line">pool.<span class="built_in">map</span>(get_page,name_list)<span class="comment">#其中一个参数是堵塞的操作，第二个应用的值，应为没有返回值所以不用接收，将列表中每一个值传入</span></span><br><span class="line">end_time=time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;%dsecond&quot;</span>%(end_time-start_time))</span><br></pre></td></tr></table></figure>

<p>返回的时间</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240102153442144.png" alt="image-20240102153442144"></p>
<p>实战：</p>
<p>爬取梨视频的视频数据</p>
<p>原则:爬取堵塞耗时的操作</p>
<p><a target="_blank" rel="noopener" href="https://www.pearvideo.com/category_1">人物热点短视频_-梨视频官网-Pear Video-梨网站</a></p>
<p>获得视频的名称和视频</p>
<p>流程：</p>
<p>1.获得页面的全部数据，视频名称和视频详情页的url</p>
<p>2.进入视频详情页进行获取视频的数据</p>
<p>这个网站又增加了反爬策略</p>
<p>验证referer 而且数据也是通过ajax加载出来的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) &#x27;</span></span><br><span class="line">                  <span class="string">&#x27;Chrome/88.0.4324.182 Safari/537.36&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;https://www.pearvideo.com/video_1790562&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># Referer参数是视频ID，必须加上不然请求不到数据，估计是梨视频的反爬机制之一</span></span><br><span class="line">url = <span class="string">&#x27;https://www.pearvideo.com/videoStatus.jsp?contId=1790562&amp;mrd=0.019795902061482185&#x27;</span></span><br><span class="line"><span class="comment"># contId为视频ID</span></span><br><span class="line"></span><br><span class="line">res = requests.get(url=url, headers=headers)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>

<p>这样可以获取视频的链接</p>
<p>然后把字典里的链接提取出来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) &#x27;</span></span><br><span class="line">                  <span class="string">&#x27;Chrome/88.0.4324.182 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;https://www.pearvideo.com/video_1790562&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># Referer参数是视频ID，必须加上不然请求不到数据，估计是梨视频的反爬机制之一</span></span><br><span class="line">url = <span class="string">&#x27;https://www.pearvideo.com/videoStatus.jsp?contId=1790562&amp;mrd=0.019795902061482185&#x27;</span></span><br><span class="line"><span class="comment"># contId为视频ID</span></span><br><span class="line"></span><br><span class="line">res = requests.get(url=url, headers=headers)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br><span class="line">json_text=json.loads(res.text)</span><br><span class="line"><span class="built_in">print</span>(json_text[<span class="string">&#x27;videoInfo&#x27;</span>][<span class="string">&#x27;videos&#x27;</span>][<span class="string">&#x27;srcUrl&#x27;</span>])<span class="comment">#可以使用json模块将该字符串解析为 Python 对象，然后获取其中的srcUrl属性</span></span><br><span class="line"><span class="comment"># print(res.text[2][2][4])如果不插入json的话就要这么写</span></span><br></pre></td></tr></table></figure>

<h2 id="单线程-异步协程（推荐）："><a href="#单线程-异步协程（推荐）：" class="headerlink" title="单线程+异步协程（推荐）："></a>单线程+异步协程（推荐）：</h2><p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103104143772.png" alt="image-20240103104143772"></p>
<p>协程方法不会在调用的时候被执行，需要把协程对象放在书简循环</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span>  <span class="keyword">def</span> <span class="title function_">request</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正在请求的url是 &quot;</span>,url)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;请求成功&quot;</span>,url)</span><br><span class="line">request(<span class="string">&#x27;www.baidu.com&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>直接执行会报错</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103104812732.png" alt="image-20240103104812732"></p>
<p>需要创建事件循环，将协程对象添加到事件循环中去</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span>  <span class="keyword">def</span> <span class="title function_">request</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正在请求的url是 &quot;</span>,url)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;请求成功&quot;</span>,url)</span><br><span class="line">c=request(<span class="string">&#x27;www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># loop=asyncio.get_event_loop()#创建循环对象</span></span><br><span class="line"><span class="comment"># loop.run_until_complete(c)#写成对象注册到loop中去</span></span><br><span class="line">asyncio.run(c)</span><br></pre></td></tr></table></figure>

<h6 id="Task的使用"><a href="#Task的使用" class="headerlink" title="Task的使用"></a>Task的使用</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span>  <span class="keyword">def</span> <span class="title function_">request</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正在请求的url是 &quot;</span>,url)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;请求成功&quot;</span>,url)</span><br><span class="line">c=request(<span class="string">&#x27;www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># loop=asyncio.get_event_loop()#创建循环对象</span></span><br><span class="line"><span class="comment"># loop.run_until_complete(c)#写成对象注册到loop中去</span></span><br><span class="line"><span class="comment"># asyncio.run(c)</span></span><br><span class="line"><span class="comment">#task的使用</span></span><br><span class="line">loop=asyncio.get_event_loop()</span><br><span class="line">task=loop.create_task(c)<span class="comment">#基于loop创建一个task对象</span></span><br><span class="line"><span class="built_in">print</span>(task)<span class="comment">#task可以显示人物的状态</span></span><br><span class="line">loop.run_until_complete(task)<span class="comment">#将任务注册到事件循环中</span></span><br><span class="line"><span class="built_in">print</span>(task)<span class="comment">#结束再来看任务的状态</span></span><br></pre></td></tr></table></figure>

<p>执行的结果</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103105742941.png" alt="image-20240103105742941"></p>
<p>pending：任务还没有被执行</p>
<p>finished：任务执行执行完毕</p>
<h6 id="future对象"><a href="#future对象" class="headerlink" title="future对象"></a>future对象</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span>  <span class="keyword">def</span> <span class="title function_">request</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正在请求的url是 &quot;</span>,url)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;请求成功&quot;</span>,url)</span><br><span class="line">c=request(<span class="string">&#x27;www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># loop=asyncio.get_event_loop()#创建循环对象</span></span><br><span class="line"><span class="comment"># loop.run_until_complete(c)#写成对象注册到loop中去</span></span><br><span class="line"><span class="comment"># asyncio.run(c)</span></span><br><span class="line"><span class="comment">#task的使用</span></span><br><span class="line"><span class="comment"># loop=asyncio.get_event_loop()</span></span><br><span class="line"><span class="comment"># task=loop.create_task(c)#基于loop创建一个task对象</span></span><br><span class="line"><span class="comment"># print(task)#task可以显示人物的状态</span></span><br><span class="line"><span class="comment"># loop.run_until_complete(task)#将任务注册到事件循环中</span></span><br><span class="line"><span class="comment"># print(task)#结束再来看任务的状态</span></span><br><span class="line"><span class="comment">#future的使用</span></span><br><span class="line">loop=asyncio.get_event_loop()</span><br><span class="line">future=asyncio.ensure_future(c)<span class="comment">#与task的不同，这个不是基loop</span></span><br><span class="line"><span class="built_in">print</span>(future)</span><br><span class="line">loop.run_until_complete(future)</span><br><span class="line"><span class="built_in">print</span>(future)</span><br></pre></td></tr></table></figure>

<p>绑定回调</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span>  <span class="keyword">def</span> <span class="title function_">request</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正在请求的url是 &quot;</span>,url)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;请求成功&quot;</span>,url)</span><br><span class="line">    <span class="keyword">return</span> url</span><br><span class="line">c=request(<span class="string">&#x27;www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># loop=asyncio.get_event_loop()#创建循环对象</span></span><br><span class="line"><span class="comment"># loop.run_until_complete(c)#写成对象注册到loop中去</span></span><br><span class="line"><span class="comment"># asyncio.run(c)</span></span><br><span class="line"><span class="comment">#task的使用</span></span><br><span class="line"><span class="comment"># loop=asyncio.get_event_loop()</span></span><br><span class="line"><span class="comment"># task=loop.create_task(c)#基于loop创建一个task对象</span></span><br><span class="line"><span class="comment"># print(task)#task可以显示人物的状态</span></span><br><span class="line"><span class="comment"># loop.run_until_complete(task)#将任务注册到事件循环中</span></span><br><span class="line"><span class="comment"># print(task)#结束再来看任务的状态</span></span><br><span class="line"><span class="comment">#future的使用</span></span><br><span class="line"><span class="comment"># loop=asyncio.get_event_loop()</span></span><br><span class="line"><span class="comment"># future=asyncio.ensure_future(c)#与task的不同，这个不是基loop</span></span><br><span class="line"><span class="comment"># print(future)</span></span><br><span class="line"><span class="comment"># loop.run_until_complete(future)</span></span><br><span class="line"><span class="comment"># print(future)</span></span><br><span class="line"><span class="comment">#绑定回调函数、</span></span><br><span class="line"><span class="comment">#先定义一个回调函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">call_back</span>(<span class="params">task</span>):</span><br><span class="line">    <span class="built_in">print</span>(task.result())</span><br><span class="line">    <span class="comment">#result方法返回的是那个的返回值</span></span><br><span class="line">loop=asyncio.get_event_loop()</span><br><span class="line">task=asyncio.ensure_future(c)</span><br><span class="line"><span class="comment">#将回调函数绑定到任务对象当中去</span></span><br><span class="line">task.add_done_callback(call_back)<span class="comment">#这里可以不用使用参数，会将创建的task的返回值当作参数</span></span><br><span class="line">loop.run_until_complete(task)</span><br></pre></td></tr></table></figure>

<h6 id="多任务协程"><a href="#多任务协程" class="headerlink" title="多任务协程"></a>多任务协程</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"> <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">requests</span>(<span class="params">url</span>):</span><br><span class="line">     <span class="built_in">print</span>(<span class="string">&quot;正在下载&quot;</span>,url)</span><br><span class="line">     time.sleep(<span class="number">2</span>)<span class="comment">#模拟下载操作</span></span><br><span class="line">     <span class="built_in">print</span>(<span class="string">&quot;下载完毕&quot;</span>,url)</span><br><span class="line">start=time.time()</span><br><span class="line">urls=[</span><br><span class="line">    <span class="number">11111111</span>,</span><br><span class="line">    <span class="number">2222222</span>,</span><br><span class="line">    <span class="number">22222223</span></span><br><span class="line">]</span><br><span class="line"><span class="comment">#存放多个任务对象</span></span><br><span class="line">status=[]</span><br><span class="line"><span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">    c=requests(url)</span><br><span class="line">    loop=asyncio.get_event_loop()</span><br><span class="line">    Future= asyncio.ensure_future(c)</span><br><span class="line">    status.append(Future)<span class="comment">#把任务放在任务列表</span></span><br><span class="line">    loop.run_until_complete(asyncio.<span class="keyword">await</span>(status))</span><br><span class="line">    <span class="built_in">print</span>(time.time()-start)</span><br></pre></td></tr></table></figure>

<p>执行后发现还是同步 的</p>
<p>原因是</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103112749814.png" alt="image-20240103112749814"></p>
<p>time.time(2)是同步操作需要导入asyncio里面的</p>
<p>修改完</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103112928100.png" alt="image-20240103112928100"></p>
<p>现在就实现异步了</p>
<h6 id="aiohttp模块"><a href="#aiohttp模块" class="headerlink" title="aiohttp模块"></a>aiohttp模块</h6><p>基于异步请求的模块</p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103190918308.png" alt="image-20240103190918308"></p>
<p><img src="https://hututu345.oss-cn-beijing.aliyuncs.com/typora/image-20240103191008405.png" alt="image-20240103191008405"></p>
<p>已经放弃的了</p>
<p>真的很难</p>
<p>n</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="John Doe"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">14</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/WANGCHANGCHEN123/WANGCHANGCHEN123.github.io" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;WANGCHANGCHEN123&#x2F;WANGCHANGCHEN123.github.io" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
